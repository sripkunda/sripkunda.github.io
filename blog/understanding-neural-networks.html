<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>understanding-neural-networks</title>
    <link rel="shortcut icon" href="/assets/favicon.jpg" />
    <link rel="stylesheet" href="/css/md.css" />
    <link rel="stylesheet" href="/css/blog.css" />
    
    <!-- Math and Code -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js" integrity="sha512-fzff82+8pzHnwA1mQ0dzz9/E0B+ZRizq08yZfya66INZBz86qKTCt9MLU0NCNIgaMJCgeyhujhasnFUsYMsi0Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/a11y-dark.min.css">

    <!-- Startup Code -->
    <script>
    let headings = []; 
    let navHeadings = [];
    let content;
    let navBar; 
    
    function scrollBehavior(e) {
        navHeadings.forEach(e => e.node.className = "");
        let closest;
        if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
            closest = navHeadings.length - 1;
        } else {
            const distances = Array.from(headings).map(e => Math.abs(e.getBoundingClientRect().top)); 
            closest = distances.indexOf(Math.min(...distances)); 
        }
        const parent = navHeadings[closest].parent; 
        const node = navHeadings[closest].node; 
        navHeadings.filter(e => e.parent == parent || e.parent == node).forEach(e => e.node.className = "open");
        navHeadings[closest].node.className = "selected open";
    }

    function load(e) {
        document.getElementById(window.location.hash?.substr(1))?.scrollIntoView();
        content = document.getElementById("blog_content");
        headings = content.querySelectorAll('h1, h2, h3');
        navBar = document.getElementsByTagName("nav")[0];
        const nav = document.getElementById("heading_tree");
        document.title = (headings[0].textContent || document.title).trim() + " | Sri Pranav Kunda";
        headings.forEach((h, i) => { 
            const node = h.cloneNode(true);
            const a = node.getElementsByTagName("a")[0];
            if (a) {
                const content = a.textContent; 
                a.remove(); 
                node.innerText = content;
            }
            nav.append(node);
            const getParent = (i) => {
                if (!navHeadings[i - 1]) return; 
                while (parseInt(navHeadings[i - 1]?.node.tagName[1]) >= parseInt(h.tagName[1])) {
                    i--; 
                }
                return navHeadings[i - 1]?.node;
            }
            navHeadings.push({ node: node, parent: getParent(i) });
            node.onclick = () => {
                headings[i].scrollIntoView({ behavior: 'smooth' });
            }
        });
        loadDropdowns();

        const isNotMarked = el => {
            while (el && el.parentNode && !el.parentNode.marked) {
            el = el.parentNode;
            if (el.marked) { return false }
            }
            return true;
        }
        [...document.querySelectorAll("p")]
            .filter(el => el.textContent.trim() === "" && isNotMarked(el) ? el.marked = true : false)
            .forEach(el => el.parentNode.removeChild(el));
    }

    const toggleMobileMenu = () => {
        navBar.style.display = navBar.style.display == "block" ? "" : "block";
    }

    const loadDropdowns = () => {
        Array.from(document.querySelectorAll("dropdown")).forEach(e => {
            const dropdown = document.createElement("div")
            dropdown.setAttribute("active", "");
            dropdown.className = "dropdown-banner";
            const inactiveBanner = `<h4 class="dropdown-label"><i class="dropdown-icon fa-solid fa-angle-right"></i> <span class="dropdown-text">${e.getAttribute("text")}</span></h4>`; 
            const activeBanner = `<h4 class="dropdown-label"><i class="dropdown-icon fa-solid fa-angle-down"></i> <span class="dropdown-text">${e.getAttribute("text")}</span></h4>`; 

            const activate = () => {
                dropdown.innerHTML = activeBanner
                div.className = "dropdown active"
                dropdown.setAttribute("active", true)
            }

            const deactivate = () => {
                dropdown.innerHTML = inactiveBanner
                div.className = "dropdown inactive"
                dropdown.setAttribute("active", "")
            }

            dropdown.onclick = () => {
                if (dropdown.getAttribute("active"))
                    deactivate()
                else
                    activate()
            }
            dropdown.innerHTML = inactiveBanner
            const div = document.createElement("div")
            e.parentNode.insertBefore(div, e)
            div.appendChild(dropdown)
            div.appendChild(e)
            const bInitActive = e.getAttribute("open") != null
            if (bInitActive) 
                activate() 
            else 
                deactivate()
            p = e.querySelector("p")
            p.style.marginTop = "2px";
        })
    }

    document.addEventListener("DOMContentLoaded", load);
    document.addEventListener("scroll", scrollBehavior);
</script>
</head>
<body>
    <div id="mobile_menu_button" onclick="toggleMobileMenu()">
        <i class="fas fa-bars"></i>
    </div>
    <nav>
    <h1 class="selected" onclick="window.location = '../'">Sri Pranav Kunda</h1>
    <span id="heading_tree">
    </span>
    <h1 onclick="window.scrollTo({ left: 0, top: 0, behavior: 'auto' })">Jump To Top</h1>
    <h1 onclick="window.scrollTo({ left: 0, top: document.body.scrollHeight, behavior: 'auto' })">Jump To Bottom</h1>
    </nav>
    <div id="blog_content">
        <h1>Understanding Neural Networks</h1><newline><p>Let's understand neural networks, both in theory and practically. We'll first discuss the theory behind how a neural network works, while also defining some of the confusing jargon that you may hear around this topic. Then we'll build a basic neural network library from scratch with only numpy (because without it, we'd spend most of our time trying to implement <a href='https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html'>ndarrays</a>). This resource is generally for people who already have seen neural networks to some extent but want to explore them at a deeper level. However, if you are interested and have a good mathematical background, you will likely be able to follow along.</p><newline><h2 id='preliminaries' tabindex='-1'><a class='header-anchor' href='#preliminaries'><span>Preliminaries</span></a></h2><newline><p>You should be familiar with differential multivariable calculus and linear algebra, especially vector and matrix operations. For a quick refresher on these concepts, you can check out <a href='https://tutorial.math.lamar.edu/'>Paul's Online Notes</a> and <a href='https://tutorial.math.lamar.edu/classes/de/LA_Matrix.aspx'>his lesson on matrices and vectors</a>.</p><newline><p>Proficiency with programming is also important for the practical implementations and background. The implementations are done in Python, but experience with other programming languages is fine.</p><newline><h3 id='review-of-vectors-and-matrices' tabindex='-1'><a class='header-anchor' href='#review-of-vectors-and-matrices'><span>Review of Vectors and Matrices</span></a></h3><newline><p>We can start by reviewing the basic operations of vectors and matrices. You should already be familair with these operations, but they are here as a reference if you need it as we will be rewriting a lot of expressions later on.</p><newline><p>Let <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>x</mi><mo separator='true'>,</mo><mi mathvariant='bold'>y</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mi>m</mi></msup></mrow><annotation encoding='application/x-tex'>\mathbf{x}, \mathbf{y} \in \mathbb{R}^m</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7335em;vertical-align:-0.1944em;'></span><span class='mord mathbf'>x</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>y</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>m</span></span></span></span></span></span></span></span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi><mo separator='true'>,</mo><mi mathvariant='bold'>Y</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{X}, \mathbf{Y} \in \mathbb{R}^{m \times n}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8805em;vertical-align:-0.1944em;'></span><span class='mord mathbf'>X</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathbf' style='margin-right:0.02875em;'>Y</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span></span></span></span></eq>. The dot product (scalar product) of two vectors is defined as:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='bold'>x</mi><mo>⋅</mo><mi mathvariant='bold'>y</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>i</mi></msub><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msup><mi mathvariant='bold'>x</mi><mi mathvariant='normal'>⊤</mi></msup><mi mathvariant='bold'>y</mi></mrow><annotation encoding='application/x-tex'>\mathbf{x} \cdot \mathbf{y} = \sum_{i = 1}^nx_iy_i = \mathbf{x}^\top\mathbf{y}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4445em;'></span><span class='mord mathbf'>x</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>⋅</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6389em;vertical-align:-0.1944em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>y</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9291em;vertical-align:-1.2777em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.0935em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathbf'>x</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8991em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>⊤</span></span></span></span></span></span></span></span><span class='mord mathbf' style='margin-right:0.01597em;'>y</span></span></span></span></span></eqn></section><p>The <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>L</mi><mi>p</mi></msub></mrow><annotation encoding='application/x-tex'>L_p</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.9694em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>L</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>p</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span></eq> norm of a vector is defined as:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='normal'>∣</mi><mi mathvariant='normal'>∣</mi><mi mathvariant='bold'>x</mi><mi mathvariant='normal'>∣</mi><msub><mi mathvariant='normal'>∣</mi><mi>p</mi></msub><mo>=</mo><msup><mrow><mo fence='true'>(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant='normal'>∣</mi><msub><mi>x</mi><mi>i</mi></msub><msup><mi mathvariant='normal'>∣</mi><mi>p</mi></msup><mo fence='true'>)</mo></mrow><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow><annotation encoding='application/x-tex'>||\mathbf{x}||_p = \left(\sum_{i = 1}^n |x_i|^p\right)^{\frac{1}{p}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.0361em;vertical-align:-0.2861em;'></span><span class='mord'>∣∣</span><span class='mord mathbf'>x</span><span class='mord'>∣</span><span class='mord'><span class='mord'>∣</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>p</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:3.3716em;vertical-align:-1.2777em;'></span><span class='minner'><span class='minner'><span class='mopen delimcenter' style='top:0em;'><span class='delimsizing size4'>(</span></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'>∣</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord'>∣</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7144em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>p</span></span></span></span></span></span></span></span><span class='mclose delimcenter' style='top:0em;'><span class='delimsizing size4'>)</span></span></span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:2.0939em;'><span style='top:-4.5029em;margin-right:0.05em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'><span class='mopen nulldelimiter sizing reset-size3 size6'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8443em;'><span style='top:-2.656em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>p</span></span></span></span><span style='top:-3.2255em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line mtight' style='border-bottom-width:0.049em;'></span></span><span style='top:-3.384em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4829em;'><span></span></span></span></span></span><span class='mclose nulldelimiter sizing reset-size3 size6'></span></span></span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>The hadamard (element-wise) product of two matrices is defined as:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='bold'>X</mi><mo>=</mo><mrow><mo fence='true'>[</mo><mtable rowspacing='0.16em' columnalign='center center center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>a</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>a</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>a</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>a</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence='true'>]</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{X} = \begin{bmatrix}a_{1,1} &amp; \cdots &amp; a_{1,n}\\\vdots &amp; \ddots &amp; \vdots \\ a_{m,1} &amp; \cdots &amp; a_{m,n}\end{bmatrix}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>X</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.26em;vertical-align:-1.88em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎣</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎡</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:0.5em;'></span><span class='arraycolsep' style='width:0.5em;'></span><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.04em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋯</span></span></span><span style='top:-3.18em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋱</span></span></span><span style='top:-1.98em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋯</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:0.5em;'></span><span class='arraycolsep' style='width:0.5em;'></span><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎦</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='bold'>Y</mi><mo>=</mo><mrow><mo fence='true'>[</mo><mtable rowspacing='0.16em' columnalign='center center center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>b</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>b</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>b</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><msub><mi>b</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence='true'>]</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{Y} = \begin{bmatrix}b_{1,1} &amp; \cdots &amp; b_{1,n}\\\vdots &amp; \ddots &amp; \vdots \\ b_{m,1} &amp; \cdots &amp; b_{m,n}\end{bmatrix}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf' style='margin-right:0.02875em;'>Y</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.26em;vertical-align:-1.88em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎣</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎡</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:0.5em;'></span><span class='arraycolsep' style='width:0.5em;'></span><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.04em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋯</span></span></span><span style='top:-3.18em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋱</span></span></span><span style='top:-1.98em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋯</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:0.5em;'></span><span class='arraycolsep' style='width:0.5em;'></span><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎦</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='bold'>X</mi><mo>⊙</mo><mi mathvariant='bold'>Y</mi><mo>=</mo><mrow><mo fence='true'>[</mo><mtable rowspacing='0.16em' columnalign='center center center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>a</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub><msub><mi>b</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>a</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub><msub><mi>b</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>a</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mn>1</mn></mrow></msub><msub><mi>b</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mo lspace='0em' rspace='0em'>⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>a</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mi>n</mi></mrow></msub><msub><mi>b</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence='true'>]</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{X} \odot \mathbf{Y} = \begin{bmatrix}a_{1,1}b_{1,1} &amp; \cdots &amp; a_{1,n}b_{1,n}\\\vdots &amp; \ddots &amp; \vdots \\ a_{m,1}b_{m,1} &amp; \cdots &amp; a_{m,n}b_{m,n}\end{bmatrix}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7694em;vertical-align:-0.0833em;'></span><span class='mord mathbf'>X</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>⊙</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf' style='margin-right:0.02875em;'>Y</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.26em;vertical-align:-1.88em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎣</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎡</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:0.5em;'></span><span class='arraycolsep' style='width:0.5em;'></span><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.04em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋯</span></span></span><span style='top:-3.18em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋱</span></span></span><span style='top:-1.98em;'><span class='pstrut' style='height:3.5em;'></span><span class='mord'><span class='minner'>⋯</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:0.5em;'></span><span class='arraycolsep' style='width:0.5em;'></span><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎦</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>The matrix-matrix product of two matrices is defined such that, for <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>A</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{A} \in \mathbb{R}^{m \times n}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7252em;vertical-align:-0.0391em;'></span><span class='mord mathbf'>A</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>A</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{A} \in \mathbb{R}^{n \times p}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7252em;vertical-align:-0.0391em;'></span><span class='mord mathbf'>A</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>n</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>p</span></span></span></span></span></span></span></span></span></span></span></span></eq>, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>C</mi><mo>=</mo><mi mathvariant='bold'>A</mi><mi mathvariant='bold'>B</mi></mrow><annotation encoding='application/x-tex'>\mathbf{C} = \mathbf{A}\mathbf{B}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>C</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>AB</span></span></span></span></eq> is a <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>m</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding='application/x-tex'>m \times p</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6667em;vertical-align:-0.0833em;'></span><span class='mord mathnormal'>m</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord mathnormal'>p</span></span></span></span></eq> matrix such that:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi>c</mi><mrow><mi>i</mi><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>a</mi><mrow><mi>i</mi><mo separator='true'>,</mo><mi>k</mi></mrow></msub><msub><mi>b</mi><mrow><mi>k</mi><mo separator='true'>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding='application/x-tex'>c_{i,j} = \sum_{k=1}^m a_{i,k}b_{k,j}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7167em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9535em;vertical-align:-1.3021em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8479em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>m</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.3021em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3361em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3361em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Similarly, a matrix-vector product is the dot product of the vector and each column vector of the matrix. In other words,</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='bold'>A</mi><mi mathvariant='bold'>x</mi><mo>=</mo><mrow><mo fence='true'>(</mo><mtable rowspacing='0.16em' columnalign='center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>a</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>a</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mn>1</mn></mrow></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mi>n</mi></mrow></msub><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence='true'>)</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{A}\mathbf{x} = \begin{pmatrix}a_{1,1}x_1 + \cdots + a_{1,n}x_n\\ \vdots \\ a_{m,1}x_1 + \cdots + a_{m,n}x_n\end{pmatrix}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>Ax</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.26em;vertical-align:-1.88em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎝</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.875em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.875em' height='0.616em' style='width:0.875em' viewBox='0 0 875 616' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V616 H291z M291 0 H417 V616 H291z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎛</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='minner'>⋯</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='minner'>⋯</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>a</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎠</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.875em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.875em' height='0.616em' style='width:0.875em' viewBox='0 0 875 616' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V616 H457z M457 0 H583 V616 H457z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎞</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Note that matrix multiplication does not commute.</p><newline><p>Some less conventional notation that is often used in machine learning is the addition of a matrices and vectors, where the objects are filled to allow for element-wise operations. For example, in <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>C</mi><mo>=</mo><mi>A</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding='application/x-tex'>C = A + b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathnormal' style='margin-right:0.07153em;'>C</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7667em;vertical-align:-0.0833em;'></span><span class='mord mathnormal'>A</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></eq>, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>C</mi><mrow><mi>i</mi><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>C_{i,j} = A_{i,j} + b_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.9694em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.07153em;'>C</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.9694em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>A</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.8444em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq>. This concept is sometimes called broadcasting. This is crucial for understanding the implementation section at the end, so check out <a href='https://numpy.org/doc/stable/user/basics.broadcasting.html'>numpy's documentation</a> for a more detailed explanation.</p><newline><h3 id='review-of-differential-calculus-for-neural-networks' tabindex='-1'><a class='header-anchor' href='#review-of-differential-calculus-for-neural-networks'><span>Review of Differential Calculus for Neural Networks</span></a></h3><newline><p>Remember that the gradient vector of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>f</mi></mrow><annotation encoding='application/x-tex'>f</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord mathnormal' style='margin-right:0.10764em;'>f</span></span></span></span></eq> at some point <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>x</mi></mrow><annotation encoding='application/x-tex'>\mathbf{x}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf'>x</span></span></span></span></eq> is going to point in the direction of the greatest increase, and the magnitude is the rate that it is increasing in that direction.</p><newline><p>This is an important detail that will become very relevant to neural networks later on.</p><newline><p>Assume that the output of our learning model is given by a function <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>:</mo><msup><mi mathvariant='double-struck'>R</mi><mi>n</mi></msup><mo>→</mo><mi mathvariant='double-struck'>R</mi></mrow><annotation encoding='application/x-tex'>\hat{y} : \mathbb{R}^n \rightarrow \mathbb{R}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>:</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>→</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord mathbb'>R</span></span></span></span></eq>:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo stretchy='false'>(</mo><mi mathvariant='bold'>x</mi><mo separator='true'>,</mo><mi mathvariant='bold'>w</mi><mo stretchy='false'>)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><msub><mi>x</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub></mrow><mo>=</mo><mi mathvariant='bold'>x</mi><mo>⋅</mo><mi mathvariant='bold'>w</mi></mrow><annotation encoding='application/x-tex'>\hat{y}(\mathbf{x}, \mathbf{w}) = \sum_{i = 1}^n{x_iw_i} = \mathbf{x} \cdot \mathbf{w}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mopen'>(</span><span class='mord mathbf'>x</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9291em;vertical-align:-1.2777em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.4445em;'></span><span class='mord mathbf'>x</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>⋅</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span></span></span></span></span></eqn></section><p>We also have another function <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>L</mi><mo>:</mo><msup><mi mathvariant='double-struck'>R</mi><mn>2</mn></msup><mo>→</mo><mi mathvariant='double-struck'>R</mi></mrow><annotation encoding='application/x-tex'>\mathcal{L} : \mathbb{R}^2 \rightarrow \mathbb{R}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathcal'>L</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>:</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8141em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8141em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>→</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord mathbb'>R</span></span></span></span></eq> that is defined as:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><mi>y</mi><mo separator='true'>,</mo><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo stretchy='false'>)</mo><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy='false'>(</mo><mi>y</mi><mo>−</mo><mover accent='true'><mi>y</mi><mo>^</mo></mover><msup><mo stretchy='false'>)</mo><mn>2</mn></msup></mrow><annotation encoding='application/x-tex'>\mathcal{L}(y, \hat{y}) = \frac{1}{2}(y - \hat{y})^2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.0074em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3214em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>2</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mopen'>(</span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1.1141em;vertical-align:-0.25em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mclose'><span class='mclose'>)</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8641em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Note that <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding='application/x-tex'>\hat{y}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span></eq> refers to the output function defined above. We now want to compute <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>w</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{w}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf mtight' style='margin-right:0.01597em;'>w</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq>. We will later find that such a situation (with a bit more complexity) will come up very often.</p><newline><p>To perform this computation, we need to use the chain rule of multiple variables. Formally written, if <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>x</mi><mo>=</mo><mi mathvariant='bold'>g</mi><mo stretchy='false'>(</mo><mi mathvariant='bold'>t</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\mathbf{x} = \mathbf{g}(\mathbf{t})</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf'>x</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>g</span><span class='mopen'>(</span><span class='mord mathbf'>t</span><span class='mclose'>)</span></span></span></span></eq>, and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>z</mi><mo>=</mo><mi>f</mi><mo stretchy='false'>(</mo><mi mathvariant='bold'>x</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>z = f(\mathbf{x})</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.10764em;'>f</span><span class='mopen'>(</span><span class='mord mathbf'>x</span><span class='mclose'>)</span></span></span></span></eq>,</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>t</mi></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>x</mi></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>x</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>t</mi></mrow></mfrac></mrow></mrow><annotation encoding='application/x-tex'>\frac{\partial z}{\partial \mathbf{t}} = {\frac{\partial z}{\partial \mathbf{x}}\frac{\partial \mathbf{x}}{\partial \mathbf{t}}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf'>t</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf'>x</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf'>t</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf'>x</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></span></eqn></section><p>For proofs of these rules, see the <a href='https://en.wikipedia.org/wiki/Chain_rule#Proofs'>wikipedia page</a>. To apply the rule to our case, the value of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>z</mi></mrow><annotation encoding='application/x-tex'>z</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span></eq> above is analogous to <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>L</mi></mrow><annotation encoding='application/x-tex'>\mathcal{L}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathcal'>L</span></span></span></span></eq>. So,</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow></mfrac><mo>=</mo><mo>−</mo><mo stretchy='false'>(</mo><mi>y</mi><mo>−</mo><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo stretchy='false'>)</mo><mo>=</mo><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>−</mo><mi>y</mi><mspace linebreak='newline'></mspace><mfrac><mrow><mi mathvariant='normal'>∂</mi><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>w</mi></mrow></mfrac><mo>=</mo><mi mathvariant='bold'>x</mi></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \hat{y}} = -(y - \hat{y}) = \hat{y} - y \\ \frac{\partial \hat{y}}{\partial \mathbf{w}} = \mathbf{x}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.2519em;vertical-align:-0.8804em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'>−</span><span class='mopen'>(</span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span class='mspace newline'></span><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf'>x</span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>w</mi></mrow></mfrac><mo>=</mo><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>w</mi></mrow></mfrac></mrow><mo>=</mo><mi mathvariant='bold'>x</mi><mo stretchy='false'>(</mo><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>−</mo><mi>y</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{w}} = {\frac{\partial \mathcal{L}}{\partial \hat{y}}\frac{\partial \hat{y}}{\partial \mathbf{w}}} = \mathbf{x}(\hat{y} - y)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.2519em;vertical-align:-0.8804em;'></span><span class='mord'><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathbf'>x</span><span class='mopen'>(</span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='mclose'>)</span></span></span></span></span></eqn></section><p>This computation that we've just done will prove useful in the future, as you'll find out soon.</p><newline><h2 id='linear-regression' tabindex='-1'><a class='header-anchor' href='#linear-regression'><span>Linear Regression</span></a></h2><newline><p>Neural networks, modeled broadly around the concept of a human brain, can be thought of as really good function approximators.</p><newline><p>They are often considered &quot;black box&quot; algorithms because, although they can approximate functions with relatively high accuracy, it can be challenging to draw patterns and relationships between data by studying the outputs and parameters of the algorithm. This will become more apparent as you begin to understand how these black boxes work.</p><newline><p>Machine learning models generally need to be trained, or fit, to some data. The data used to train the model is called the training data, and the data used to test the model is called the testing data.</p><newline><p>We can stay away from the concept of a &quot;neural network&quot; for a bit and look at something that might be more familiar: linear regression.</p><newline><p>Say we have a matrix of data <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>X</mi></mrow><annotation encoding='application/x-tex'>\mathcal{X}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathcal' style='margin-right:0.14643em;'>X</span></span></span></span></eq>, where each column vector <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>x</mi></mrow><annotation encoding='application/x-tex'>\mathbf{x}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf'>x</span></span></span></span></eq> represents a single data sample.</p><newline><p>Generally, the data samples are indexed using <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq>, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msup><mi mathvariant='bold'>x</mi><mrow><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{x}^{(i)}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.888em;'></span><span class='mord'><span class='mord mathbf'>x</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.888em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>i</span><span class='mclose mtight'>)</span></span></span></span></span></span></span></span></span></span></span></span></eq> represents the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq>th sample and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msup><mi>y</mi><mrow><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo></mrow></msup></mrow><annotation encoding='application/x-tex'>y^{(i)}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.0824em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.888em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>i</span><span class='mclose mtight'>)</span></span></span></span></span></span></span></span></span></span></span></span></eq> represents the respective label. The equation for linear regression is given by the general equation of a linear line. Note that we generally use <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding='application/x-tex'>\hat{y}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span></eq> to represent the predicted value.</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>w</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><mi>b</mi><mo>=</mo><msup><mi mathvariant='bold'>w</mi><mi mathvariant='normal'>⊤</mi></msup><mi mathvariant='bold'>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding='application/x-tex'>\hat{y} = w_1x_1 + w_2x_2 + \cdots + w_nx_n + b = \mathbf{w}^\top \mathbf{x} + b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.7333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6667em;vertical-align:-0.0833em;'></span><span class='minner'>⋯</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.7333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.9824em;vertical-align:-0.0833em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8991em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>⊤</span></span></span></span></span></span></span></span><span class='mord mathbf'>x</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></span></eqn></section><p>The <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>b</mi></mrow><annotation encoding='application/x-tex'>b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></eq> value in the equation represents a bias, which works as a constant &quot;offset&quot; for all predictions. In other words, we can move the function up or down in accordance with the data.</p><newline><p>It is usually comptuationally (and mathematically) convenient to split our data into smaller partitions called batches. We train the model using each batch rather than each individual data sample. If we do this, we can rewrite the equation from before using a matrix-vector product, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi></mrow><annotation encoding='application/x-tex'>\mathbf{X}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>X</span></span></span></span></eq> represents a batch of data in <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>X</mi></mrow><annotation encoding='application/x-tex'>\mathcal{X}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathcal' style='margin-right:0.14643em;'>X</span></span></span></span></eq>.</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='bold'>X</mi><mo>=</mo><mrow><mo fence='true'>[</mo><mtable rowspacing='0.16em' columnalign='center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><msup><mi mathvariant='bold'>x</mi><mrow><mo stretchy='false'>(</mo><mn>1</mn><mo stretchy='false'>)</mo><mi mathvariant='normal'>⊤</mi></mrow></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><msup><mi mathvariant='bold'>x</mi><mrow><mo stretchy='false'>(</mo><mi>n</mi><mo stretchy='false'>)</mo><mi mathvariant='normal'>⊤</mi></mrow></msup></mstyle></mtd></mtr></mtable><mo fence='true'>]</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{X} = \begin{bmatrix}\mathbf{x}^{(1)\top} \\ \vdots \\ \mathbf{x}^{(n)\top}\end{bmatrix}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>X</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.356em;vertical-align:-1.928em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎣</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎡</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.428em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathbf'>x</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.888em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mtight'>1</span><span class='mclose mtight'>)</span><span class='mord mtight'>⊤</span></span></span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1195em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathbf'>x</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.888em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>n</span><span class='mclose mtight'>)</span><span class='mord mtight'>⊤</span></span></span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.928em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎦</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.6667em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi mathvariant='bold'>y</mi><mo>^</mo></mover><mo>=</mo><mrow><mo fence='true'>(</mo><mtable rowspacing='0.16em' columnalign='center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>x</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>x</mi><mrow><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub><msub><mi>w</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi>x</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mn>1</mn></mrow></msub><msub><mi>w</mi><mn>1</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>x</mi><mrow><mi>m</mi><mo separator='true'>,</mo><mi>n</mi></mrow></msub><msub><mi>w</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence='true'>)</mo></mrow><mo>+</mo><mi mathvariant='bold'>b</mi><mo>=</mo><mi mathvariant='bold'>X</mi><mi mathvariant='bold'>w</mi><mo>+</mo><mi mathvariant='bold'>b</mi></mrow><annotation encoding='application/x-tex'>\mathbf{\hat{y}} = \begin{pmatrix}x_{1,1}w_1 + \cdots + x_{1,n}w_n\\ \vdots \\ x_{m,1}w_1 + \cdots + x_{m,n}w_n\end{pmatrix} + \mathbf{b}= \mathbf{X}\mathbf{w} + \mathbf{b}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.9023em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.7079em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>y</span></span><span style='top:-3.0134em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.2875em;'><span class='mord mathbf'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.26em;vertical-align:-1.88em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎝</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.875em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.875em' height='0.616em' style='width:0.875em' viewBox='0 0 875 616' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V616 H291z M291 0 H417 V616 H291z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎛</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='minner'>⋯</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='minner'>⋯</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1514em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎠</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.875em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.875em' height='0.616em' style='width:0.875em' viewBox='0 0 875 616' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V616 H457z M457 0 H583 V616 H457z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎞</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathbf'>b</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7694em;vertical-align:-0.0833em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>Xw</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathbf'>b</span></span></span></span></span></eqn></section><p>Looking at the new equation, we can see that our prediction is now a vector, and the bias is also a vector. This is because we add one bias term and return a prediction for each data sample in the batch. Logically, for <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{X} \in \mathbb{R}^{m \times n}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7252em;vertical-align:-0.0391em;'></span><span class='mord mathbf'>X</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span></span></span></span></eq>, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>w</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mi>n</mi></msup></mrow><annotation encoding='application/x-tex'>\mathbf{w} \in \mathbb{R}^n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5782em;vertical-align:-0.0391em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>b</mi><mo separator='true'>,</mo><mover accent='true'><mi mathvariant='bold'>y</mi><mo>^</mo></mover><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mi>m</mi></msup></mrow><annotation encoding='application/x-tex'>\mathbf{b}, \mathbf{\hat{y}} \in \mathbb{R}^m</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.9023em;vertical-align:-0.1944em;'></span><span class='mord mathbf'>b</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.7079em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>y</span></span><span style='top:-3.0134em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.2875em;'><span class='mord mathbf'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>m</span></span></span></span></span></span></span></span></span></span></span></eq>.</p><newline><blockquote><newline><p>Note that <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>b</mi></mrow><annotation encoding='application/x-tex'>\mathbf{b}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathbf'>b</span></span></span></span></eq> is a vector of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>m</mi></mrow><annotation encoding='application/x-tex'>m</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>m</span></span></span></span></eq> of the same values from above.</p><newline></blockquote><newline><p>In other words, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi></mrow><annotation encoding='application/x-tex'>\mathbf{X}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>X</span></span></span></span></eq> is a batch with <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>m</mi></mrow><annotation encoding='application/x-tex'>m</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>m</span></span></span></span></eq> samples, each with <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> features. After multiplying each feature by some weight, we add a bias to each sample and output a vector of predictions.</p><newline><p>Surprise! We've made a basic neural network (kind of). We can call the model above a linear neural network. This will make more sense once we discuss the architecure of a neural network (which just so happens to be the topic of the next section).</p><newline><h2 id='neural-network-architecture' tabindex='-1'><a class='header-anchor' href='#neural-network-architecture'><span>Neural Network Architecture</span></a></h2><newline><p>An artificial neural network (ANN) is a machine learning algorithm that uses a set of connected nodes (called neurons) arranged in groups called layers.</p><newline><p>Usually, nodes are connected to each other with each connection holding some quantity called a weight. Each node can also have a bias term, which is essentially the same as the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>b</mi></mrow><annotation encoding='application/x-tex'>b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></eq> value we discussed above.</p><newline><h3 id='a-closer-look-at-linear-regression' tabindex='-1'><a class='header-anchor' href='#a-closer-look-at-linear-regression'><span>A Closer Look at Linear Regression</span></a></h3><newline><p>To make more sense of this, let's view the regression model that we observed in the last section as a neural network.</p><newline><p><img src='https://i.imgur.com/N1jlqM9.png' alt=''></p><newline><p>Above, we have a basic neural network. Each column of neurons (nodes) are called layers.</p><newline><p>The first layer is called the input layer, and it is the only layer that does not have inputs from a previous layer. The last layer is called the output layer, and it is the only layer that does not output to another layer. The layers in the middle are called hidden layers (in this example we only have one hidden layer).</p><newline><p>In this network, we have <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> input neurons, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq> hidden neurons, and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>1</mn></mrow><annotation encoding='application/x-tex'>1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq> output neuron.</p><newline><p>By the time our input <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>x</mi></mrow><annotation encoding='application/x-tex'>\mathbf{x}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf'>x</span></span></span></span></eq> to the first layer travels to the output layer, the resulting value is the predicted value <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding='application/x-tex'>\hat{y}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span></eq>.</p><newline><p>The output of a single neuron in a neural network is going to be the following, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>o</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>o_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5806em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> is the output of the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq>th neuron in the previous layer:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>o</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>=</mo><msup><mi mathvariant='bold'>w</mi><mi mathvariant='normal'>⊤</mi></msup><mi mathvariant='bold'>o</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding='application/x-tex'>\sum_{i=1}^n o_iw_i + b = \mathbf{w}^\top\mathbf{o} + b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.9291em;vertical-align:-1.2777em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.9824em;vertical-align:-0.0833em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8991em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>⊤</span></span></span></span></span></span></span></span><span class='mord mathbf'>o</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></span></eqn></section><p><strong>The only exception is the output of the neurons in the input layer, which output <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>x_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5806em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> from the data inputted to the network.</strong> This means that the output of layer <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq>, the input layer, is always <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>x</mi></mrow><annotation encoding='application/x-tex'>\mathbf{x}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf'>x</span></span></span></span></eq>.</p><newline><p>Notice that this expression is the same as the output of our regression model. The neural network structured above is just the regression model represented using neurons and layers.</p><newline><h3 id='weights-and-hidden-layers' tabindex='-1'><a class='header-anchor' href='#weights-and-hidden-layers'><span>Weights and Hidden Layers</span></a></h3><newline><p>Let's look at an example where we have a hidden layer.</p><newline><p><img src='https://i.imgur.com/IWReBPD.png' alt=''></p><newline><p>We now have many more weights, with a total of 2 layers that affect the input (not counting the input layer, because that doesn't affect the input).</p><newline><p>To manage these transformations, let's count the number of connections we have. From the input layer to the hidden layer, there are <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding='application/x-tex'>m \times n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6667em;vertical-align:-0.0833em;'></span><span class='mord mathnormal'>m</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> weights. From the first hidden layer to the output layer, there are <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> weights. We can represent these weights as matrices.</p><newline><p>Each group of weights can be viewed as independent from each other, as each one also applies a separate transformation on the output of the previous layer.</p><newline><p>Let's first generalize the equation for the output of a single neuron to multiple layers, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mo separator='true'>,</mo><mi>j</mi><mo separator='true'>,</mo><mi>k</mi></mrow></msub></mrow><annotation encoding='application/x-tex'>w_{i,j,k}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7167em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3361em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span></eq> is the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>k</mi></mrow><annotation encoding='application/x-tex'>k</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal' style='margin-right:0.03148em;'>k</span></span></span></span></eq>th component of the weights vector connecting to the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>j</mi></mrow><annotation encoding='application/x-tex'>j</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.854em;vertical-align:-0.1944em;'></span><span class='mord mathnormal' style='margin-right:0.05724em;'>j</span></span></span></span></eq>th neuron in layer <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq> :</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi>o</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>o</mi><mrow><mi>i</mi><mo separator='true'>,</mo><mi>k</mi></mrow></msub><msub><mi>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi><mo separator='true'>,</mo><mi>k</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo>=</mo><msubsup><mi mathvariant='bold'>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow><mi mathvariant='normal'>⊤</mi></msubsup><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding='application/x-tex'>o_{i+1,j} = \sum^n_{k=0}o_{i,k}w_{i+1,j,k} + b_{i+1,j} = \mathbf{w}_{i+1,j}^\top\mathbf{o}_i + b_{i+1,j}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7167em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9535em;vertical-align:-1.3021em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8479em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span><span class='mrel mtight'>=</span><span class='mord mtight'>0</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.3021em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3361em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.02691em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3361em;'><span style='top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.03148em;'>k</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.9805em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.2822em;vertical-align:-0.3831em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8991em;'><span style='top:-2.453em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>⊤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.3831em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.9805em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>By definition, we can write the output of the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq>th layer <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>\mathbf{o}_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> as:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>o</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo fence='true'>(</mo><mtable rowspacing='0.16em' columnalign='center' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi mathvariant='bold'>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mn>1</mn></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mi><mi mathvariant='normal'>⋮</mi><mpadded height='0em' voffset='0em'><mspace mathbackground='black' width='0em' height='1.5em'></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi mathvariant='bold'>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr></mtable><mo fence='true'>)</mo></mrow><mo>=</mo><msubsup><mi mathvariant='bold'>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi mathvariant='normal'>⊤</mi></msubsup><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub><mo>+</mo><msub><mi mathvariant='bold'>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding='application/x-tex'>\mathbf{o}_{i+1} = \begin{pmatrix}\mathbf{o}_i \cdot \mathbf{w}_{i+1,1} + b_{i+1,1} \\ \vdots \\ \mathbf{o}_i \cdot \mathbf{w}_{i+1,n} + b_{i+1,n}\end{pmatrix} = \mathbf{W}_{i+1}^\top\mathbf{o}_i + \mathbf{b}_{i+1}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6528em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:4.26em;vertical-align:-1.88em;'></span><span class='minner'><span class='mopen'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎝</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.875em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.875em' height='0.616em' style='width:0.875em' viewBox='0 0 875 616' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V616 H291z M291 0 H417 V616 H291z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎛</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span><span class='mord'><span class='mtable'><span class='col-align-c'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.38em;'><span style='top:-5.2275em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>⋅</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.3675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord'>⋮</span><span class='mord rule' style='border-right-width:0em;border-top-width:1.5em;bottom:0em;'></span></span></span></span><span style='top:-2.1675em;'><span class='pstrut' style='height:3.6875em;'></span><span class='mord'><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>⋅</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight'>n</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.88em;'><span></span></span></span></span></span></span></span><span class='mclose'><span class='delimsizing mult'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:2.35em;'><span style='top:-1.95em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎠</span></span></span><span style='top:-3.097em;'><span class='pstrut' style='height:3.155em;'></span><span style='height:0.616em;width:0.875em;'><svg xmlns='http://www.w3.org/2000/svg' width='0.875em' height='0.616em' style='width:0.875em' viewBox='0 0 875 616' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V616 H457z M457 0 H583 V616 H457z'/></svg></span></span><span style='top:-4.35em;'><span class='pstrut' style='height:3.155em;'></span><span class='delimsizinginner delim-size4'><span>⎞</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.85em;'><span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.2044em;vertical-align:-0.3053em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8991em;'><span style='top:-2.453em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>⊤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.3053em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.9028em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p><eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>d</mi><mo>×</mo><mi>h</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{W}_{i} \in \mathbb{R}^{d \times h}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8491em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8491em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>d</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>h</span></span></span></span></span></span></span></span></span></span></span></span></eq> is the matrix of weights connecting to layer <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq> with input dimensionality <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>d</mi></mrow><annotation encoding='application/x-tex'>d</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>d</span></span></span></span></eq> and output dimensionality <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>h</mi></mrow><annotation encoding='application/x-tex'>h</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>h</span></span></span></span></eq>. Likewise, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mi>d</mi></msup></mrow><annotation encoding='application/x-tex'>\mathbf{o}_i \in \mathbb{R}^{d}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6891em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8491em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8491em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>d</span></span></span></span></span></span></span></span></span></span></span></span></eq> is the output vector of layer <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq>.</p><newline><p>To extend this to batches of data, we can use a matrix <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mi>i</mi></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{O}_i \in \mathbb{R}^{n \times d}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8491em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8491em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>n</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>d</span></span></span></span></span></span></span></span></span></span></span></span></eq> to represent the output of a layer for batch size <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> and output dimensionality <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>d</mi></mrow><annotation encoding='application/x-tex'>d</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>d</span></span></span></span></eq>.</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant='bold'>O</mi><mi>i</mi></msub><msub><mi mathvariant='bold'>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi mathvariant='bold'>b</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding='application/x-tex'>\mathbf{O}_{i+1} = \mathbf{O}_i\mathbf{W}_{i+1} + \mathbf{b}_{i+1}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.9028em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub><mo>=</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>b</mi><mn>1</mn></msub></mrow><annotation encoding='application/x-tex'>\mathbf{O}_{1} = \mathbf{X}\mathbf{W}_{1} + \mathbf{b}_1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.8444em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>b</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Another way to think of that second equation is that <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mn>0</mn></msub><mo>=</mo><mi mathvariant='bold'>X</mi></mrow><annotation encoding='application/x-tex'>\mathbf{O}_0 = \mathbf{X}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>0</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6861em;'></span><span class='mord mathbf'>X</span></span></span></span></eq>, meaning that the input layer outputs the matrix of the data in the batch.</p><newline><p>This type of neural network, where we go forward in only one direction (as opposed to allowing connections to neurons of previous layers) is called a feedforward neural network (FFNN). We only talk about FFNNs in this post. The term &quot;multilayer perceptron&quot; also is used loosely to refer to FFNNs.</p><newline><h3 id='deep-neural-networks-(dnns)' tabindex='-1'><a class='header-anchor' href='#deep-neural-networks-(dnns)'><span>Deep Neural Networks (DNNs)</span></a></h3><newline><p>A deep neural network is one with multiple layers contained between the input and output layers.</p><newline><p><img src='https://i.imgur.com/uf5XdLE.png' alt=''></p><newline><p>The network above has three hidden layers. The weights for each of these layers can be represented as matrices <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>d</mi><mo>×</mo><mi>m</mi></mrow></msup><mo separator='true'>,</mo><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>m</mi><mo>×</mo><mi>p</mi></mrow></msup><mo separator='true'>,</mo><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>p</mi><mo>×</mo><mi>q</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{W}_1 \in \mathbb{R}^{d \times m}, \mathbf{W}_2 \in \mathbb{R}^{m \times p}, \mathbf{W}_3 \in \mathbb{R}^{p \times q}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.0435em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8491em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>d</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>m</span></span></span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.9658em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>m</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>p</span></span></span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>p</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight' style='margin-right:0.03588em;'>q</span></span></span></span></span></span></span></span></span></span></span></span></eq>. Remember, the input is <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>n</mi><mo>×</mo><mi>d</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{X} \in \mathbb{R}^{n \times d}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7252em;vertical-align:-0.0391em;'></span><span class='mord mathbf'>X</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8491em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8491em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>n</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>d</span></span></span></span></span></span></span></span></span></span></span></span></eq> and the biases are <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mn>1</mn><mo>×</mo><mi>n</mi></mrow></msup><mo separator='true'>,</mo><msub><mi mathvariant='bold'>c</mi><mn>2</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mn>1</mn><mo>×</mo><mi>m</mi></mrow></msup><mo separator='true'>,</mo><msub><mi mathvariant='bold'>c</mi><mn>3</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mn>1</mn><mo>×</mo><mi>q</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{c}_1 \in \mathbb{R}^{1 \times n}, \mathbf{c}_2 \in \mathbb{R}^{1 \times m}, \mathbf{c}_3 \in \mathbb{R}^{1 \times q}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6891em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.0085em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8141em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.0085em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8141em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>m</span></span></span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8141em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8141em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight' style='margin-right:0.03588em;'>q</span></span></span></span></span></span></span></span></span></span></span></span></eq>. Note that the bias matrices are broadcasted to add the bias to every row of the output.</p><newline><p>Based on the formula above, we can say that the output of our <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>4</mn></mrow><annotation encoding='application/x-tex'>4</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>4</span></span></span></span></eq>th layer is our predicted value <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding='application/x-tex'>\hat{y}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span></eq>. So, we can write that the output of this neural network is:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub><mo>=</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><mspace linebreak='newline'></mspace><msub><mi mathvariant='bold'>O</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>2</mn></msub><mspace linebreak='newline'></mspace><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>=</mo><msub><mi mathvariant='bold'>O</mi><mn>3</mn></msub><mo>=</mo><msub><mi mathvariant='bold'>O</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'><newline> \mathbf{O}_{1} = \mathbf{X}\mathbf{W}_{1} + \mathbf{c}_1 \\<newline>  \mathbf{O}_2 = \mathbf{O}_1\mathbf{W}_{2} + \mathbf{c}_2 \\<newline> \hat{y} = \mathbf{O}_3 = \mathbf{O}_2 \mathbf{W}_{3} + \mathbf{c}_3<newline></annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span><span class='mspace newline'></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span><span class='mspace newline'></span><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>3</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Substituting the values of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub><mo separator='true'>,</mo><mo>…</mo><mo separator='true'>,</mo><msub><mi mathvariant='bold'>O</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'>\mathbf{O}_1, \dots, \mathbf{O}_3</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8805em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'>…</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq>, we get:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>=</mo><mo stretchy='false'>(</mo><munder><munder><mrow><mo fence='true'>(</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><mo fence='true'>)</mo></mrow><mo stretchy='true'>⏟</mo></munder><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub></munder><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>2</mn></msub><mo stretchy='false'>)</mo><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'>\hat{y} = (\underbrace{\left(\mathbf{X}\mathbf{W}_{1} + \mathbf{c}_1\right)}_{\mathbf{O}_1} \mathbf{W}_{2} + \mathbf{c}_{2})\mathbf{W}_{3} + \mathbf{c}_{3}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.4284em;vertical-align:-1.6784em;'></span><span class='mopen'>(</span><span class='mord munder'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.75em;'><span style='top:-1.4217em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'><span class='mord mathbf mtight'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3173em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord munder'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.75em;'><span class='svg-align' style='top:-2.102em;'><span class='pstrut' style='height:3em;'></span><span class='stretchy' style='height:0.548em;min-width:1.6em;'><span class='brace-left' style='height:0.548em;'><svg xmlns='http://www.w3.org/2000/svg' width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13<newline> 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688<newline> 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7<newline>-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class='brace-center' style='height:0.548em;'><svg xmlns='http://www.w3.org/2000/svg' width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214<newline>c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14<newline> 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3<newline> 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0<newline>-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class='brace-right' style='height:0.548em;'><svg xmlns='http://www.w3.org/2000/svg' width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3<newline> 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237<newline>-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='minner'><span class='mopen delimcenter' style='top:0em;'>(</span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose delimcenter' style='top:0em;'>)</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.898em;'><span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.6784em;'><span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>3</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>3</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'>\hat{y} = \mathbf{X}\mathbf{W}_1\mathbf{W}_2\mathbf{W}_3 + \mathbf{c}_1\mathbf{W}_2\mathbf{W}_3 + \mathbf{c}_2\mathbf{W}_3 + \mathbf{c}_3</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Now that we're here, note that in terms of the mathematics, we don't actually care what the value of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'>\mathbf{X}\mathbf{W}_1\mathbf{W}_2\mathbf{W}_3</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> or <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'>\mathbf{c}_1\mathbf{W}_2\mathbf{W}_3</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> is. The neural network can hold any real values in the weights and biases, so the result is arbitrary regardless.</p><newline><p>With that said, let's look at the shapes of the outputs here: <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub></mrow><annotation encoding='application/x-tex'>\mathbf{X}\mathbf{W}_1\mathbf{W}_2\mathbf{W}_3</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> gives us a result in <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>n</mi><mo>×</mo><mi>r</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbb{R}^{n \times r}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>n</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight' style='margin-right:0.02778em;'>r</span></span></span></span></span></span></span></span></span></span></span></span></eq>, and the remaining bias terms return a result in a single bias term in <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msup><mi mathvariant='double-struck'>R</mi><mrow><mn>1</mn><mo>×</mo><mi>n</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbb{R}^{1 \times n}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8141em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8141em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span></span></span></span></eq>.</p><newline><p>If we look more closely, at this, we can see that this can also be rewritten back to a single layered neural network, but now <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>∈</mo><msup><mi mathvariant='double-struck'>R</mi><mrow><mi>n</mi><mo>×</mo><mi>r</mi></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{W}_1 \in \mathbb{R}^{n \times r}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∈</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7713em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>n</span><span class='mbin mtight'>×</span><span class='mord mathnormal mtight' style='margin-right:0.02778em;'>r</span></span></span></span></span></span></span></span></span></span></span></span></eq>:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub></mrow><annotation encoding='application/x-tex'>\hat{y} = \mathbf{X}\mathbf{W}_1 + \mathbf{c}_1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.5944em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>So, what's the point in having multiple layers? The answer is, there is no point! For linear models, having multiple layers not very useful. So now we have two problems: our model's output is linear, and we can't actually use the concept of multiple layers.</p><newline><h3 id='activation-functions' tabindex='-1'><a class='header-anchor' href='#activation-functions'><span>Activation Functions</span></a></h3><newline><p>Now that we've established that multiple layers are useless for linear models, let's try to solve that---and escape the trap of linearity at the same time.</p><newline><p>The most straightforward way to tackle the latter problem is to simply introduce some type of non-linearity to the outputs. To make use of the multiple layers at the same time, we can introduce a nonlinear transformation at each layer oytput. This transformation is called an activation function.</p><newline><p>The activation function is some function <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>σ</mi><mo>:</mo><mi mathvariant='double-struck'>R</mi><mo>→</mo><mi mathvariant='double-struck'>R</mi></mrow><annotation encoding='application/x-tex'>\sigma : \mathbb{R} \rightarrow \mathbb{R}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>:</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord mathbb'>R</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>→</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord mathbb'>R</span></span></span></span></eq> that acts on the output such that the output of a single neuron is now:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi>o</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mi>σ</mi><mrow><mo fence='true'>(</mo><msubsup><mi mathvariant='bold'>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow><mi mathvariant='normal'>⊤</mi></msubsup><msub><mi mathvariant='bold'>o</mi><mi>i</mi></msub><mo>+</mo><msub><mi>c</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn><mo separator='true'>,</mo><mi>j</mi></mrow></msub><mo fence='true'>)</mo></mrow></mrow><annotation encoding='application/x-tex'>o_{i+1,j} = \sigma\left(\mathbf{w}_{i+1,j}^\top\mathbf{o}_i + c_{i+1,j}\right)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7167em;vertical-align:-0.2861em;'></span><span class='mord'><span class='mord mathnormal'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.2822em;vertical-align:-0.3831em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'><span class='mopen delimcenter' style='top:0em;'><span class='delimsizing size1'>(</span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8991em;'><span style='top:-2.453em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>⊤</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.3831em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf'>o</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span><span class='mpunct mtight'>,</span><span class='mord mathnormal mtight' style='margin-right:0.05724em;'>j</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2861em;'><span></span></span></span></span></span></span><span class='mclose delimcenter' style='top:0em;'><span class='delimsizing size1'>)</span></span></span></span></span></span></span></eqn></section><p>Modifying the rest appropriately, we get (note that <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>σ</mi></mrow><annotation encoding='application/x-tex'>\sigma</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span></span></span></span></eq> is applied element-wise):</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>σ</mi><mrow><mo fence='true'>(</mo><msub><mi mathvariant='bold'>O</mi><mi>i</mi></msub><msub><mi mathvariant='bold'>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo fence='true'>)</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{O}_{i+1} = \sigma\left(\mathbf{O}_i\mathbf{W}_{i+1} + \mathbf{c}_{i+1}\right)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'><span class='mopen delimcenter' style='top:0em;'>(</span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mclose delimcenter' style='top:0em;'>)</span></span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub><mo>=</mo><mi>σ</mi><mrow><mo fence='true'>(</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><mo fence='true'>)</mo></mrow></mrow><annotation encoding='application/x-tex'>\mathbf{O}_{1} = \sigma\left(\mathbf{X}\mathbf{W}_{1} + \mathbf{c}_1\right)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'><span class='mopen delimcenter' style='top:0em;'>(</span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose delimcenter' style='top:0em;'>)</span></span></span></span></span></span></eqn></section><p>So now, if we were to do the same expansion from before but with these nonlinearities, we get:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mover accent='true'><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi>σ</mi><mo stretchy='false'>(</mo><mi>σ</mi><mo stretchy='false'>(</mo><munder><munder><mrow><mi>σ</mi><mo stretchy='false'>(</mo><mi mathvariant='bold'>X</mi><msub><mi mathvariant='bold'>W</mi><mn>1</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>1</mn></msub><mo stretchy='false'>)</mo></mrow><mo stretchy='true'>⏟</mo></munder><msub><mi mathvariant='bold'>O</mi><mn>1</mn></msub></munder><msub><mi mathvariant='bold'>W</mi><mn>2</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>2</mn></msub><mo stretchy='false'>)</mo><msub><mi mathvariant='bold'>W</mi><mn>3</mn></msub><mo>+</mo><msub><mi mathvariant='bold'>c</mi><mn>3</mn></msub><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\hat{y} = \sigma(\sigma(\underbrace{\sigma(\mathbf{X}\mathbf{W}_{1} + \mathbf{c}_1)}_{\mathbf{O}_1} \mathbf{W}_{2} + \mathbf{c}_{2})\mathbf{W}_{3} + \mathbf{c}_{3})</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.4284em;vertical-align:-1.6784em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mopen'>(</span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mopen'>(</span><span class='mord munder'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.75em;'><span style='top:-1.4217em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'><span class='mord mathbf mtight'>O</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3173em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord munder'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.75em;'><span class='svg-align' style='top:-2.102em;'><span class='pstrut' style='height:3em;'></span><span class='stretchy' style='height:0.548em;min-width:1.6em;'><span class='brace-left' style='height:0.548em;'><svg xmlns='http://www.w3.org/2000/svg' width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMinYMin slice'><path d='M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13<newline> 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688<newline> 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7<newline>-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z'/></svg></span><span class='brace-center' style='height:0.548em;'><svg xmlns='http://www.w3.org/2000/svg' width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMidYMin slice'><path d='M199572 214<newline>c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14<newline> 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3<newline> 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0<newline>-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z'/></svg></span><span class='brace-right' style='height:0.548em;'><svg xmlns='http://www.w3.org/2000/svg' width='400em' height='0.548em' viewBox='0 0 400000 548' preserveAspectRatio='xMaxYMin slice'><path d='M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3<newline> 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237<newline>-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z'/></svg></span></span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mopen'>(</span><span class='mord mathbf'>X</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.898em;'><span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.6784em;'><span></span></span></span></span></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>3</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathbf'>c</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>3</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span></span></span></span></eqn></section><p>Notice that we cannot rewrite this as a single expression because each entire output is transformed with an arbitrary nonlinear transformation.</p><newline><p>Let's look at some common activation functions. The graphs are from <a href='https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html'>PyTorch's documentation</a>.</p><newline><h4>Rectified Linear Unit (ReLu)</h4><newline><p>ReLu is generally most common activation function as it provides just enough nonlinearity to be useful, allows for quick learning, and is mathematically convenient. The output is:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mtext>ReLu</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>=</mo><mi>max</mi><mo>⁡</mo><mo stretchy='false'>(</mo><mi>x</mi><mo separator='true'>,</mo><mn>0</mn><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\text{ReLu}(x) = \max(x, 0)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>ReLu</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mop'>max</span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'>0</span><span class='mclose'>)</span></span></span></span></span></eqn></section><p>The graph follows directly as a regular linear line, cut off at <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq> for all negative values of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>x</mi></mrow><annotation encoding='application/x-tex'>x</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>x</span></span></span></span></eq>.</p><newline><p><img src='https://pytorch.org/docs/stable/_images/ReLU.png' alt='Graph of ReLu Activation Function'></p><newline><h4>Sigmoid</h4><newline><p>The output of a sigmoid function is restricted between <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>1</mn></mrow><annotation encoding='application/x-tex'>1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq>, as you will see below, so it is usually used when you want to output a probability from the model (or any other value from 0 to 1).</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mtext>Sigmoid</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\text{Sigmoid}(x) = \frac{1}{1 + e^{-x}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>Sigmoid</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.0908em;vertical-align:-0.7693em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3214em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>e</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6973em;'><span style='top:-2.989em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>−</span><span class='mord mathnormal mtight'>x</span></span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.7693em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></eqn></section><p>The graph is:</p><newline><p><img src='https://pytorch.org/docs/stable/_images/Sigmoid.png' alt='Graph of Sigmoid Activation Function'></p><newline><h4>Tanh</h4><newline><p>The tanh activation function is analogous to the hyperbolic tangent function, meaning that the values are restricted between <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding='application/x-tex'>-1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7278em;vertical-align:-0.0833em;'></span><span class='mord'>−</span><span class='mord'>1</span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>1</mn></mrow><annotation encoding='application/x-tex'>1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq> as shown:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mtext>Tanh</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo>=</mo><mi>tanh</mi><mo>⁡</mo><mi>x</mi><mo>=</mo><mfrac><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><mrow><msup><mi>e</mi><mi>x</mi></msup><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\text{Tanh}(x) = \tanh{x} = \frac{e^x - e^{-x}}{e^x + e^{-x}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>Tanh</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mop'>tanh</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal'>x</span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.2177em;vertical-align:-0.7693em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.4483em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>e</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.5904em;'><span style='top:-2.989em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>x</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>e</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6973em;'><span style='top:-2.989em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>−</span><span class='mord mathnormal mtight'>x</span></span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>e</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>x</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal'>e</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7713em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>−</span><span class='mord mathnormal mtight'>x</span></span></span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.7693em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></eqn></section><p><img src='https://pytorch.org/docs/stable/_images/Tanh.png' alt='Graph of Sigmoid Activation Function'></p><newline><p>We'll explore these activation functions (and their derivatives) more in the next section.</p><newline><h3 id='what-are-weights-and-biases%3F' tabindex='-1'><a class='header-anchor' href='#what-are-weights-and-biases%3F'><span>What Are Weights and Biases?</span></a></h3><newline><p>So far, we've talked about these arbitrary objects called weights and biases. Although they were defined vaguely, it's likely that what they are doesn't completely make sense yet. To define them, we need to discuss how the learning in neural networks happens.</p><newline><p>Initially, these parameters are randomized by some algorithm. It turns out that the initial values of our weights and biases is very nontrivial. There are different methods of initialization that will be discussed later.</p><newline><p>Learning in machine learning generally involves the tuning of some parameters such that the prediction gets closer and closer to the actual value. Likewise, neural networks learn by tuning internal parameters, called weights and biases, so that we get as accurate as possible. The actual process of how that is done is detailed in the next section.</p><newline><p>There are also parameters that are generally not optimized within the model (they are still optimized, just in different ways). These are called hyperparameters. These are separate from the model parameters as the model parameters can be inferred directly from the data input. Some examples of hyperparameters in neural networks include the number of layers, the output dimensionalities of the layers, and the activation functions that are utilized.</p><newline><p>Now that we have defined the structure of nonlinear and linear neural networks, we can put it all together into something called the forward pass. For each pass, we send in a batch of data <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msup><mi mathvariant='bold'>X</mi><mrow><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{X}^{(i)}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.888em;'></span><span class='mord'><span class='mord mathbf'>X</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.888em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>i</span><span class='mclose mtight'>)</span></span></span></span></span></span></span></span></span></span></span></span></eq>. There is one forward pass per batch, and a single <strong>epoch</strong> has <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> forward passes, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> is the number of batches. We will wrap up this whole process in the next section after we discuss backpropagation.</p><newline><h2 id='going-backwards' tabindex='-1'><a class='header-anchor' href='#going-backwards'><span>Going Backwards</span></a></h2><newline><p>Everything we've talked about so far---that is, the computation of the output of the neural network transformed by some weights and activation functions---is sometimes referred to as the forward pass (because we are going forward through each layer until we reach the output layer).</p><newline><p>However, just giving us a prediction won't get us too far, because then our neural network would just be guessing. Let's explore how our neural network can learn the appropriate weights and biases for some data.</p><newline><h3 id='measuring-inaccuracy' tabindex='-1'><a class='header-anchor' href='#measuring-inaccuracy'><span>Measuring Inaccuracy</span></a></h3><newline><p>To learn anything, we also need to know what we are doing wrong. Neural networks learn from their mistakes, but this is only possible if we know how &quot;much of a mistake&quot; we are making. This means that we need some way to tell how innacurate our model is so that we can figure out what to do and when to stop.</p><newline><p>A loss function quantifies this error, meaning that we have a scalar-valued function that returns a quantity representing the innacuracy of our model. There are various loss functions that are used in neural networks, but we will only be discussing the squared error loss function. It is defined as:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mtext>MSE</mtext><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy='false'>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent='true'><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy='false'>)</mo><mn>2</mn></msup></mrow><annotation encoding='application/x-tex'>\text{MSE} = \frac{1}{n}\sum_{i = 1}^n(y_i-\hat{y}_i)^2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord text'><span class='mord'>MSE</span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9291em;vertical-align:-1.2777em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3214em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord mathnormal'>n</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1.1141em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'><span class='mclose'>)</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8641em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p><eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> is the number of data points considered. The scalar output of this function gives a number that represents the overall innacuracy of the model.</p><newline><p>Now, all that's left (and the fun part) is to minimize the innacuracy (therefore maximizing the accuracy) of the model.</p><newline><h3 id='gradient-descent-(gd)' tabindex='-1'><a class='header-anchor' href='#gradient-descent-(gd)'><span>Gradient Descent (GD)</span></a></h3><newline><p>We have a scalar valued function that returns the loss of the model given some weights and biases. If we can figure out the point at the global minimum of the loss function, we can find the weights that result in the lowest loss (resulting in the highest accuracy).</p><newline><p>The idea is that we can use optimization methods to find this global minimum. Ideally, we would look for some type of analytical solution, but the functions outputted by neural networks generally don't allow for closed form solutions to finding the extremum.</p><newline><p>For its computational efficiency and effectiveness, this optimization is done through an iterative process called gradient descent.</p><newline><p>If you need a refresher on some of the concepts of calculus, look at the <a href='#preliminaries'>preliminaries</a> section.</p><newline><h4>The Algorithm</h4><newline><p>We first start with some initial value of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mn>0</mn></msub></mrow><annotation encoding='application/x-tex'>\mathbf{W}_0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>0</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq>. This represents the initial values of the weights we are updating in the network.</p><newline><p>Assume that we already have the gradient of the weights with respect to the  loss <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>W</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{W}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf mtight' style='margin-right:0.01597em;'>W</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> (we'll discuss how to compute this later). This shows us how the loss function changes in accordance with the weights.</p><newline><p>Now, we set some arbitrary positive learning rates denoted <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mo stretchy='false'>{</mo><msub><mi>η</mi><mi>i</mi></msub><mo stretchy='false'>}</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding='application/x-tex'>\{\eta_i\} &gt; 0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mopen'>{</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>}</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>&gt;</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq>.</p><newline><p>For <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator='true'>,</mo><mn>2</mn><mo separator='true'>,</mo><mo>…</mo></mrow><annotation encoding='application/x-tex'>i = 1, 2, \dots</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8389em;vertical-align:-0.1944em;'></span><span class='mord'>1</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'>2</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'>…</span></span></span></span></eq> (in the context of neural networks, we actually take one step for each forward pass of the network):</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant='bold'>W</mi><mi>i</mi></msub><mo>−</mo><msub><mi>η</mi><mi>i</mi></msub><mi mathvariant='normal'>∇</mi><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><msub><mi mathvariant='bold'>W</mi><mi>i</mi></msub><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\mathbf{W}_{i + 1} = \mathbf{W}_i - \eta_i\nabla\mathcal{L}(\mathbf{W}_i)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'>∇</span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span></span></span></span></eqn></section><p>Intuitively, we are taking a step in the opposite (negative) direction of the gradient for each iteration of the algorithm. Since the gradient points in the direction of the greatest increase, we are going to go in the opposite direction to travel towards the greatest decrease. If we keep going in this direction, we expect to eventually end up at a minimum.</p><newline><p>The learning rate <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>η</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>\eta_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> can also be thought of as the step size. One step in GD is defined as a single update of the weights. Varying this learning rate appropriately also leads to some interesting techniques that we will discuss.</p><newline><p>It is important to note that in GD we expect to perform the forward pass for every single sample in the data set to perform a single update to the parameters. This will prove to be extremely inefficient for larger datasets.</p><newline><p>Note that we update the biases in a similar fashion, taking <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>b</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{b}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf mtight'>b</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> instead of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>W</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{W}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf mtight' style='margin-right:0.01597em;'>W</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> and adjusting the update rule appropriately.</p><newline><p>There are other variants of gradient descent that are used in deep learning. Usually, libraries provide <a href='https://pytorch.org/docs/stable/optim.html?highlight=optim#module-torch.optim'>multiple &quot;optimizers&quot;</a> (optimization algorithms) as certain algorithms perform better in certain scenarios. In this post, we'll only talk about one of those algorithms. Vanilla gradient descent (discussed in the previous section) is very uncommon for training neural networks.</p><newline><h4>Stochastic Gradient Descent (SGD)</h4><newline><p>Both gradient descent (GD) and stochastic gradient descent (SGD) are very similar. The difference in SGD is that we go forward for only a <strong>subset</strong> of data in the dataset instead of the entire dataset.</p><newline><p>By doing this, we also get much noiser loss landscapes, meaning that we might be less likely to get stuck in a local minimum, as the noise sometimes causes the gradient to stray away from the local minima (and the global minimum).</p><newline><p>Another technique, varying the learning rate, is often used to control the convergence of the algorithm. If we do not vary the learning rate, it can become very difficult to reach convergence at an optimal point.</p><newline><p>It is especially important in SGD because of the noisiness of the objective function. In the gradient descent example, we had a set of constant learning rates for each iteration. However, decaying the learning rate exponentially (and <a href='https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate'>other methods</a>) also exist:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi>η</mi><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo><mo>=</mo><mfrac><msub><mi>η</mi><mn>0</mn></msub><msup><mi>e</mi><mrow><mi>λ</mi><mi>i</mi></mrow></msup></mfrac></mrow><annotation encoding='application/x-tex'>\eta(i) = \frac{\eta_0}{e^{\lambda i}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='mopen'>(</span><span class='mord mathnormal'>i</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.7936em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.1076em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal'>e</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7751em;'><span style='top:-2.989em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>λi</span></span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>0</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></eqn></section><blockquote><newline><p>In the exponential decay, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>λ</mi></mrow><annotation encoding='application/x-tex'>\lambda</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>λ</span></span></span></span></eq> is known as the decay constant. It controls the rate at which the learning rate decays.</p><newline></blockquote><newline><p>If we decay the learning rate too quickly, convergence time will increase significantly. However, if we don't decay enough, we risk not reaching the optimal point because of the all the noise.</p><newline><p>In addition, sometimes the effectiveness of the learning rate differs for each dimension in the function. When the gradients are sufficiently low in one dimension but not so much in another, the effectiveness of the learning rate in one dimension might vary from another.</p><newline><p>To compensate for this, we introduce the concept of momentum. Momentum allows us to fix this problem by taking into account the values of the previous gradients when taking the next step. More formally,</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>U</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>α</mi><msub><mi mathvariant='bold'>U</mi><mi>i</mi></msub><mo>−</mo><mi>η</mi><mi mathvariant='normal'>∇</mi><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><msub><mi mathvariant='bold'>U</mi><mi>i</mi></msub><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\mathbf{U}_{i + 1} = \alpha\mathbf{U}_i - \eta \nabla\mathcal{L}(\mathbf{U}_i)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf'>U</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathnormal' style='margin-right:0.0037em;'>α</span><span class='mord'><span class='mord mathbf'>U</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='mord'>∇</span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord'><span class='mord mathbf'>U</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant='bold'>W</mi><mi>i</mi></msub><mo>+</mo><msub><mi mathvariant='bold'>U</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>\mathbf{W}_{i + 1} = \mathbf{W}_i + \mathbf{U}_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf'>U</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>With some substitution, we can rewrite this as a single update rule:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>W</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi mathvariant='bold'>W</mi><mi>i</mi></msub><mo>−</mo><mi>η</mi><mi mathvariant='normal'>∇</mi><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><msub><mi mathvariant='bold'>U</mi><mi>i</mi></msub><mo stretchy='false'>)</mo><mo>+</mo><mi>α</mi><msub><mi mathvariant='bold'>U</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>\mathbf{W}_{i + 1} = \mathbf{W}_i - \eta \nabla\mathcal{L}(\mathbf{U}_i) + \alpha\mathbf{U}_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8944em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>W</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='mord'>∇</span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord'><span class='mord mathbf'>U</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.8361em;vertical-align:-0.15em;'></span><span class='mord mathnormal' style='margin-right:0.0037em;'>α</span><span class='mord'><span class='mord mathbf'>U</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>We also have a variable <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn><mo>≤</mo><mi>α</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding='application/x-tex'>0 \le \alpha \le 1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7804em;vertical-align:-0.136em;'></span><span class='mord'>0</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>≤</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7719em;vertical-align:-0.136em;'></span><span class='mord mathnormal' style='margin-right:0.0037em;'>α</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>≤</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq> that determines how &quot;important&quot; the previous gradient is for each step of gradient descent.</p><newline><h3 id='overfitting-and-regularization' tabindex='-1'><a class='header-anchor' href='#overfitting-and-regularization'><span>Overfitting and Regularization</span></a></h3><newline><p>In some cases, fitting our neural network to a dataset may result in something called overfitting. This happens when the neural network gets so &quot;used to&quot; the training data that the model won't give as accurate predictions when it encounters new, slightly different data.</p><newline><p>The idea behind regularization is to solve this problem by putting a penalty on the weights in our loss function. Our previous loss function can be reiterated in terms of vectors <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>w</mi></mrow><annotation encoding='application/x-tex'>\mathbf{w}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4444em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>b</mi></mrow><annotation encoding='application/x-tex'>b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></eq> as shown below:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><mi mathvariant='bold'>w</mi><mo separator='true'>,</mo><mi>b</mi><mo stretchy='false'>)</mo><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy='false'>(</mo><msup><mi>y</mi><mrow><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo></mrow></msup><mo>−</mo><msup><mover accent='true'><mi>y</mi><mo>^</mo></mover><mrow><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo></mrow></msup><msup><mo stretchy='false'>)</mo><mn>2</mn></msup></mrow><annotation encoding='application/x-tex'>\mathcal{L}(\mathbf{w}, b) = \frac 1 n\sum^n_{i = 1}(y^{(i)} - \hat{y}^{(i)})^2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathnormal'>b</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9291em;vertical-align:-1.2777em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3214em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord mathnormal'>n</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.938em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>i</span><span class='mclose mtight'>)</span></span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1.188em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.938em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>i</span><span class='mclose mtight'>)</span></span></span></span></span></span></span></span></span><span class='mclose'><span class='mclose'>)</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8641em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>With reguralization, we take the sum of this loss function and the norm of our weight vector, such that our loss becomes:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><mi mathvariant='bold'>w</mi><mo separator='true'>,</mo><mi>b</mi><mo stretchy='false'>)</mo><mo>+</mo><mfrac><mi>λ</mi><mn>2</mn></mfrac><mi mathvariant='normal'>∣</mi><mi mathvariant='normal'>∣</mi><mi mathvariant='bold'>w</mi><mi mathvariant='normal'>∣</mi><msubsup><mi mathvariant='normal'>∣</mi><mi>n</mi><mn>2</mn></msubsup></mrow><annotation encoding='application/x-tex'>\mathcal{L}(\mathbf{w}, b) + \frac \lambda 2||\mathbf{w}||_n^2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathnormal'>b</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>2</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord mathnormal'>λ</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'>∣∣</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='mord'>∣</span><span class='mord'><span class='mord'>∣</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8641em;'><span style='top:-2.453em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.247em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Note that in <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding='application/x-tex'>L_1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>L</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> regularization, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding='application/x-tex'>n = 1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq>, and for <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding='application/x-tex'>L_2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>L</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> regularization, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding='application/x-tex'>n = 1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq>. Regularization is also called weight decay.</p><newline><p>By doing this, we expect that if our weights get too big, our optimizer will eventually try to minimize the norm of the weights instead of just the loss. The parameter <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding='application/x-tex'>\lambda &gt; 0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7335em;vertical-align:-0.0391em;'></span><span class='mord mathnormal'>λ</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>&gt;</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq> is what determines the magnitude of our penalty, and we can set <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>λ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding='application/x-tex'>\lambda = 0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>λ</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq> to get our old loss function back. This is a hyperparameter (the meaning of this will be defined later) called the regularization constant. The multiplication by <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding='application/x-tex'>\frac 1 2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.1901em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8451em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> is simply for convenience, as the derivative settles nicely because the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>2</mn></mrow><annotation encoding='application/x-tex'>2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>2</span></span></span></span></eq> from the power cancels out with the division.</p><newline><p>Assuming we are using SGD as our optimizer and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding='application/x-tex'>L_2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>L</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> regularization, we can also add the regularization to the update rule by taking its derivative:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><msub><mi mathvariant='bold'>w</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>←</mo><msub><mi mathvariant='bold'>w</mi><mi>i</mi></msub><mo stretchy='false'>(</mo><mn>1</mn><mo>−</mo><msub><mi>η</mi><mi>i</mi></msub><mi>λ</mi><mo stretchy='false'>)</mo><mo>−</mo><msub><mi>η</mi><mi>i</mi></msub><mi mathvariant='normal'>∇</mi><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><mi mathvariant='bold'>w</mi><mo separator='true'>,</mo><mi>b</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\mathbf{w}_{i + 1} \leftarrow \mathbf{w}_i(1 - \eta_i\lambda) - \eta_i\nabla\mathcal{L}(\mathbf{w}, b)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6528em;vertical-align:-0.2083em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mbin mtight'>+</span><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.2083em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>←</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.016em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mopen'>(</span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord mathnormal'>λ</span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>η</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'>∇</span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord mathbf' style='margin-right:0.01597em;'>w</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathnormal'>b</span><span class='mclose'>)</span></span></span></span></span></eqn></section><h3 id='automatic-differentiation-(autodiff)' tabindex='-1'><a class='header-anchor' href='#automatic-differentiation-(autodiff)'><span>Automatic Differentiation (Autodiff)</span></a></h3><newline><p>To compute the derivatives, namely <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='bold'>w</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{w}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathbf mtight' style='margin-right:0.01597em;'>w</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mover accent='true'><mi mathvariant='bold'>y</mi><mo>^</mo></mover></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial \mathbf{\hat{y}}}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.3612em;vertical-align:-0.4811em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord accent mtight'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.7079em;'><span style='top:-2.7em;'><span class='pstrut' style='height:2.7em;'></span><span class='mord mathbf mtight' style='margin-right:0.01597em;'>y</span></span><span style='top:-2.7134em;'><span class='pstrut' style='height:2.7em;'></span><span class='accent-body' style='left:-0.2875em;'><span class='mord mathbf mtight'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4811em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq>, we use a method called automatic differentation. Automatic differentiation provides the numerical (not analytical) solution to the derivative of a function at a certain point.</p><newline><p>There are two &quot;variants&quot; of automatic differentiation, each more efficient for a certain use case. For some function <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>f</mi><mo>:</mo><msup><mi mathvariant='double-struck'>R</mi><mi>m</mi></msup><mo>→</mo><msup><mi mathvariant='double-struck'>R</mi><mi>n</mi></msup></mrow><annotation encoding='application/x-tex'>f : \mathbb{R}^m \rightarrow \mathbb{R}^n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord mathnormal' style='margin-right:0.10764em;'>f</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>:</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>m</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>→</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span></span></span></span></eq>, forward mode is more efficient when <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>m</mi><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding='application/x-tex'>m &lt; n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5782em;vertical-align:-0.0391em;'></span><span class='mord mathnormal'>m</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>&lt;</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq>. In the other case, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>m</mi><mo>&gt;</mo><mi>n</mi></mrow><annotation encoding='application/x-tex'>m &gt; n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5782em;vertical-align:-0.0391em;'></span><span class='mord mathnormal'>m</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>&gt;</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq>, reverse mode is more efficient, and this it is what we use for computing derivatives in deep learning.</p><newline><h4>Overview</h4><newline><p>To understand the concept of reverse autodiff, we need to go back to the multivariable chain rule that we talked about in the beginning of this post.</p><newline><p>For some function <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>L</mi><mo>:</mo><msup><mi mathvariant='double-struck'>R</mi><mi>n</mi></msup><mo>→</mo><mi mathvariant='double-struck'>R</mi></mrow><annotation encoding='application/x-tex'>\mathcal{L} : \mathbb{R}^n \rightarrow \mathbb{R}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathcal'>L</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>:</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.6644em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>→</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6889em;'></span><span class='mord mathbb'>R</span></span></span></span></eq>, we want the partial derivatives <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mo separator='true'>,</mo><mo>…</mo><mo separator='true'>,</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial x_1}, \dots, \frac{\partial \mathcal{L}}{\partial x_n}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.3252em;vertical-align:-0.4451em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mtight'><span class='mord mathnormal mtight'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3173em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4451em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'>…</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mtight'><span class='mord mathnormal mtight'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1645em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4451em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq>. To compute this in the human way, we would either take a limit or (preferably) use some of our handy rules of differentiation. Turns out that a computer isn't too different.</p><newline><p>For some intuition before getting into the mathematics, we are going to split the computation of our gradient into two parts. First, we will go forward and record the operations that were done from our starting point in what is called a gradient tape. Then, we will go in backwards order and apply the derivative equivalent of the operation on the appropriate parameters, updating the gradients in accordance with the differentiation rules.</p><newline><p>Say we have:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator='true'>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy='false'>)</mo><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy='false'>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy='false'>)</mo><mtext> find </mtext><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>x</mi></mrow></mfrac><mtext> and </mtext><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>y</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\mathcal{L}(x_1, x_2) = x_1x_2 + \sin(x_1) \text{ find } \frac{\partial \mathcal{L}}{\partial x} \text{ and } \frac{\partial \mathcal{L}}{\partial y}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:2.2519em;vertical-align:-0.8804em;'></span><span class='mop'>sin</span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span><span class='mord text'><span class='mord'> find </span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal'>x</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord text'><span class='mord'> and </span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></eqn></section><p>We first rewrite this in terms of abstracted compositions of expressions:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mtable rowspacing='0.25em' columnalign='right left' columnspacing='0em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mi>z</mi></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mo>=</mo><mi mathvariant='script'>L</mi><mo stretchy='false'>(</mo><mi>x</mi><mo separator='true'>,</mo><mi>y</mi><mo stretchy='false'>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mo>=</mo><msub><mi>γ</mi><mn>1</mn></msub><msub><mi>γ</mi><mn>2</mn></msub><mo>+</mo><mi>sin</mi><mo>⁡</mo><mo stretchy='false'>(</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy='false'>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mo>=</mo><msub><mi>γ</mi><mn>3</mn></msub><mo>+</mo><msub><mi>γ</mi><mn>4</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mo>=</mo><msub><mi>γ</mi><mn>5</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding='application/x-tex'>\begin{align*}<newline>    z &amp; = \mathcal{L}(x, y) \\<newline>    &amp; = \gamma_1\gamma_2 + \sin(\gamma_1) \\ <newline>    &amp; = \gamma_3 + \gamma_4 \\<newline>    &amp; = \gamma_5<newline>\end{align*}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:6em;vertical-align:-2.75em;'></span><span class='mord'><span class='mtable'><span class='col-align-r'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:3.25em;'><span style='top:-5.41em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span><span style='top:-3.91em;'><span class='pstrut' style='height:3em;'></span><span class='mord'></span></span><span style='top:-2.41em;'><span class='pstrut' style='height:3em;'></span><span class='mord'></span></span><span style='top:-0.91em;'><span class='pstrut' style='height:3em;'></span><span class='mord'></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:2.75em;'><span></span></span></span></span></span><span class='col-align-l'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:3.25em;'><span style='top:-5.41em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord mathcal'>L</span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='mclose'>)</span></span></span><span style='top:-3.91em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mop'>sin</span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span></span><span style='top:-2.41em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-0.91em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:2.75em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Now, we compute the value of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>γ</mi><mn>5</mn></msub></mrow><annotation encoding='application/x-tex'>\gamma_5</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> and record each of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>γ</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>\gamma_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> in what is called the gradient &quot;tape.&quot; Next, we go in the reverse order and compute the derivatives. However, let's first recall the chain rule for this context:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mtext>For a function </mtext><mi>f</mi><mo>:</mo><msup><mi mathvariant='double-struck'>R</mi><mi>m</mi></msup><mo>→</mo><mi mathvariant='double-struck'>R</mi><mtext> in which </mtext><mi>z</mi><mo>=</mo><mi>f</mi><mspace linebreak='newline'></mspace><mtext> and the argument of </mtext><mi>f</mi><mtext> is a function </mtext><mi mathvariant='bold'>x</mi><mo stretchy='false'>(</mo><mi>t</mi><mo stretchy='false'>)</mo><mo separator='true'>,</mo></mrow><annotation encoding='application/x-tex'>\text{For a function } f : \mathbb{R}^m \rightarrow \mathbb{R} \text{ in which } z = f \\\text{ and the argument of } f \text{ is a function } \mathbf{x}(t), </annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord text'><span class='mord'>For a function </span></span><span class='mord mathnormal' style='margin-right:0.10764em;'>f</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>:</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7144em;'></span><span class='mord'><span class='mord mathbb'>R</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.7144em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>m</span></span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>→</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathbb'>R</span><span class='mord text'><span class='mord'> in which </span></span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.8889em;vertical-align:-0.1944em;'></span><span class='mord mathnormal' style='margin-right:0.10764em;'>f</span></span><span class='mspace newline'></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'> and the argument of </span></span><span class='mord mathnormal' style='margin-right:0.10764em;'>f</span><span class='mord text'><span class='mord'> is a function </span></span><span class='mord mathbf'>x</span><span class='mopen'>(</span><span class='mord mathnormal'>t</span><span class='mclose'>)</span><span class='mpunct'>,</span></span></span></span></span></eqn></section><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>t</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'> <newline>\frac{\partial z}{\partial t} = \sum_i \frac{\partial z}{\partial x_i}\frac{\partial x_i}{\partial t}<newline></annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal'>t</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.6491em;vertical-align:-1.2777em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.05em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.836em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal'>t</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></eqn></section><p>Using this rule, we can write <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>1</mn></msub></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial z}{\partial \gamma_1}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.3612em;vertical-align:-0.4811em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mtight'><span class='mord mathnormal mtight' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3173em;'><span style='top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight' style='margin-right:0.04398em;'>z</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4811em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>2</mn></msub></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial z}{\partial \gamma_2}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.3612em;vertical-align:-0.4811em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mtight'><span class='mord mathnormal mtight' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3173em;'><span style='top:-2.357em;margin-left:-0.0556em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight' style='margin-right:0.04398em;'>z</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4811em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> as a chained composition of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>γ</mi><mn>3</mn></msub><mo separator='true'>,</mo><msub><mi>γ</mi><mn>4</mn></msub><mo separator='true'>,</mo><msub><mi>γ</mi><mn>5</mn></msub></mrow><annotation encoding='application/x-tex'>\gamma_3, \gamma_4, \gamma_5</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq>.</p><newline><p>Now, let's go step by step for the reverse-mode differentiation:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mtable rowspacing='0.25em' columnalign='right left' columnspacing='0em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mtext> (seed)</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>5</mn></msub></mrow></mfrac><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>4</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>5</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>5</mn></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>4</mn></msub></mrow></mfrac><mo>=</mo><mn>1</mn><mo>×</mo><mn>1</mn><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>3</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>5</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>5</mn></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>3</mn></msub></mrow></mfrac><mo>=</mo><mn>1</mn><mo>×</mo><mn>1</mn><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>3</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>3</mn></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>2</mn></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>4</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>4</mn></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><mn>1</mn><mo>×</mo><msub><mi>γ</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn><mo>×</mo><mn>0</mn><mo>=</mo><msub><mi>γ</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='true'><mrow><mrow></mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>3</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>3</mn></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>1</mn></msub></mrow></mfrac><mo>+</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>4</mn></msub></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>4</mn></msub></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>γ</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><mn>1</mn><mo>×</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn><mo>×</mo><mi>cos</mi><mo>⁡</mo><mo stretchy='false'>(</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy='false'>)</mo><mo>=</mo><msub><mi>γ</mi><mn>2</mn></msub><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy='false'>(</mo><msub><mi>γ</mi><mn>1</mn></msub><mo stretchy='false'>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding='application/x-tex'> <newline>\begin{align*}<newline>&amp; \frac{\partial z}{\partial z} = 1 \text{ (seed)} \\<newline>&amp; \frac{\partial z}{\partial \gamma_5} = 1 \\<newline>&amp; \frac{\partial z}{\partial \gamma_4} = \frac{\partial z}{\partial \gamma_5} \frac{\partial \gamma_5}{\partial \gamma_4} = 1 \times 1 = 1 \\<newline>&amp; \frac{\partial z}{\partial \gamma_3} = \frac{\partial z}{\partial \gamma_5} \frac{\partial \gamma_5}{\partial \gamma_3} = 1 \times 1 = 1 \\<newline>&amp; \frac{\partial z}{\partial \gamma_2} = \frac{\partial z}{\partial \gamma_3} \frac{\partial \gamma_3}{\partial \gamma_2} + \frac{\partial z}{\partial \gamma_4} \frac{\partial \gamma_4}{\partial \gamma_2} = 1 \times \gamma_1 + 1 \times 0 = \gamma_1 \\ <newline>&amp; \frac{\partial z}{\partial \gamma_1} = \frac{\partial z}{\partial \gamma_3} \frac{\partial \gamma_3}{\partial \gamma_1} + \frac{\partial z}{\partial \gamma_4} \frac{\partial \gamma_4}{\partial \gamma_1} = 1 \times \gamma_2 + 1 \times \cos(<newline>\gamma_1) = \gamma_2 + \cos(\gamma_1)<newline>\end{align*}<newline></annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:15.1168em;vertical-align:-7.3084em;'></span><span class='mord'><span class='mtable'><span class='col-align-r'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:7.8084em;'><span style='top:-9.8084em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'></span></span><span style='top:-7.451em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'></span></span><span style='top:-4.8991em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'></span></span><span style='top:-2.3472em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'></span></span><span style='top:0.2047em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'></span></span><span style='top:2.7565em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:7.3084em;'><span></span></span></span></span></span><span class='col-align-l'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:7.8084em;'><span style='top:-9.8084em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'><span class='mord'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span><span class='mord text'><span class='mord'> (seed)</span></span></span></span><span style='top:-7.451em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'><span class='mord'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span></span></span><span style='top:-4.8991em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'><span class='mord'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span></span></span><span style='top:-2.3472em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'><span class='mord'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>5</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span></span></span><span style='top:0.2047em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'><span class='mord'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'>0</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:2.7565em;'><span class='pstrut' style='height:3.3714em;'></span><span class='mord'><span class='mord'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>3</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>4</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.8804em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>×</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mop'>cos</span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mop'>cos</span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:-0.0556em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:7.3084em;'><span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>Notice how we went step by step in the backwards direction. If we program the basic derivative rules, we can see that adding a number <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>γ</mi></mrow><annotation encoding='application/x-tex'>\gamma</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.625em;vertical-align:-0.1944em;'></span><span class='mord mathnormal' style='margin-right:0.05556em;'>γ</span></span></span></span></eq> adds to the derivative of the parent operation to the current derivative, multiplying a number by another number <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>c</mi></mrow><annotation encoding='application/x-tex'>c</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>c</span></span></span></span></eq> adds the product of <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>c</mi></mrow><annotation encoding='application/x-tex'>c</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>c</span></span></span></span></eq> and the derivative of the parent operation, etc.</p><newline><p>By generalizing these rules and chaining them together, we are able to compute the derivatives <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mo separator='true'>,</mo><mo>…</mo><mo separator='true'>,</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mi>n</mi></msub></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial x_1}, \dots, \frac{\partial \mathcal{L}}{\partial x_n}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.3252em;vertical-align:-0.4451em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mtight'><span class='mord mathnormal mtight'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3173em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4451em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='minner'>…</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mtight'><span class='mord mathnormal mtight'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.1645em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal mtight'>L</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4451em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq> with complexity <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>O</mi><mo stretchy='false'>(</mo><mn>1</mn><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\mathcal{O}(1)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord mathcal' style='margin-right:0.02778em;'>O</span><span class='mopen'>(</span><span class='mord'>1</span><span class='mclose'>)</span></span></span></span></eq>.</p><newline><p>The final result from our computation above is:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac><mo>=</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi>cos</mi><mo>⁡</mo><mo stretchy='false'>(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy='false'>)</mo><mspace linebreak='newline'></mspace><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi mathvariant='script'>L</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding='application/x-tex'>\frac{\partial \mathcal{L}}{\partial x_1} = x_2 + \cos(x_1) \\ \frac{\partial \mathcal{L}}{\partial x_2}=  x_1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.2074em;vertical-align:-0.836em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.836em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7333em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mop'>cos</span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'>)</span></span><span class='mspace newline'></span><span class='base'><span class='strut' style='height:2.2074em;vertical-align:-0.836em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathcal'>L</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.836em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.5806em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>x</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3011em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>In neural networks, the algorithm that computes the derivatives of the weight and bias objects is called backpropagation. Backpropagation uses reverse-mode automatic differentation to compute the gradients of the weights in the same way that is described above.</p><newline><blockquote><newline><p>In case you need clarification, the functions produced by neural networks are not like the example function <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='script'>L</mi></mrow><annotation encoding='application/x-tex'>\mathcal{L}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathcal'>L</span></span></span></span></eq> shown above. They are made up of function composition (activation functions) and matrix multiplications (output of each layer).</p><newline></blockquote><newline><h3 id='derivatives-of-activation-functions' tabindex='-1'><a class='header-anchor' href='#derivatives-of-activation-functions'><span>Derivatives of Activation Functions</span></a></h3><newline><p>Generally, the derivatives of activation functions are hard-coded in deep learning libraries. Let's discuss these derivatives and their graphs here so that we can use them later in our implementations.</p><newline><h4>ReLu</h4><newline><p><eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>σ</mi><mo>=</mo><mtext>ReLu</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\sigma = \text{ReLu}(x)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>ReLu</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span></span></span></span></eq></p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>σ</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mrow><mo fence='true'>{</mo><mtable rowspacing='0.36em' columnalign='left left' columnspacing='1em'><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><mtext>if </mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel='0' displaystyle='false'><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel='0' displaystyle='false'><mrow><mtext>if </mtext><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding='application/x-tex'>\frac{\partial \sigma}{\partial x} = \begin{cases}1 &amp; \text{if }x &gt; 0 \\ 0 &amp; \text{if }x &lt; 0 \end{cases}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal'>x</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:3em;vertical-align:-1.25em;'></span><span class='minner'><span class='mopen delimcenter' style='top:0em;'><span class='delimsizing size4'>{</span></span><span class='mord'><span class='mtable'><span class='col-align-l'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.69em;'><span style='top:-3.69em;'><span class='pstrut' style='height:3.008em;'></span><span class='mord'><span class='mord'>1</span></span></span><span style='top:-2.25em;'><span class='pstrut' style='height:3.008em;'></span><span class='mord'><span class='mord'>0</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.19em;'><span></span></span></span></span></span><span class='arraycolsep' style='width:1em;'></span><span class='col-align-l'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.69em;'><span style='top:-3.69em;'><span class='pstrut' style='height:3.008em;'></span><span class='mord'><span class='mord text'><span class='mord'>if </span></span><span class='mord mathnormal'>x</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>&gt;</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>0</span></span></span><span style='top:-2.25em;'><span class='pstrut' style='height:3.008em;'></span><span class='mord'><span class='mord text'><span class='mord'>if </span></span><span class='mord mathnormal'>x</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>&lt;</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mord'>0</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.19em;'><span></span></span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></span></eqn></section><p>Notice that the derivative is undefined at <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding='application/x-tex'>x = 0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>x</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq>. Generally it is rare to have <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>x</mi></mrow><annotation encoding='application/x-tex'>x</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>x</span></span></span></span></eq> at <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq> in the context of neural networks, so we just assume that the derivative is <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>1</mn></mrow><annotation encoding='application/x-tex'>1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq>, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq>, or <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0.5</mn></mrow><annotation encoding='application/x-tex'>0.5</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0.5</span></span></span></span></eq> for the sake of a cleaner and less error-prone implementation.</p><newline><h4>Sigmoid</h4><newline><p><eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>σ</mi><mo>=</mo><mtext>Sigmoid</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\sigma = \text{Sigmoid}(x)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>Sigmoid</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span></span></span></span></eq></p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>σ</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mtext>Sigmoid</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo stretchy='false'>(</mo><mn>1</mn><mo>−</mo><mtext>Sigmoid</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\frac{\partial \sigma}{\partial x} = \text{Sigmoid}(x)(1 - \text{Sigmoid}(x))</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal'>x</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>Sigmoid</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span><span class='mopen'>(</span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>Sigmoid</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>))</span></span></span></span></span></eqn></section><h4>Tanh</h4><newline><p><eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>σ</mi><mo>=</mo><mtext>Tanh</mtext><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\sigma = \text{Tanh}(x)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1em;vertical-align:-0.25em;'></span><span class='mord text'><span class='mord'>Tanh</span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span></span></span></span></eq></p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>σ</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><msup><mtext>Tanh</mtext><mn>2</mn></msup><mo stretchy='false'>(</mo><mi>x</mi><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>\frac{\partial \sigma}{\partial x} = 1 - \text{Tanh}^2(x)</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:2.0574em;vertical-align:-0.686em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3714em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal'>x</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal' style='margin-right:0.03588em;'>σ</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.7278em;vertical-align:-0.0833em;'></span><span class='mord'>1</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1.1484em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord text'><span class='mord'>Tanh</span></span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8984em;'><span style='top:-3.1473em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span></span></span></span></span><span class='mopen'>(</span><span class='mord mathnormal'>x</span><span class='mclose'>)</span></span></span></span></span></eqn></section><h3 id='the-backwards-pass' tabindex='-1'><a class='header-anchor' href='#the-backwards-pass'><span>The Backwards Pass</span></a></h3><newline><p>Now we have a set of tools for learning: a way to compute derivatives, some loss functions, and a number of methods for optimizing this loss function. Let's put this all together and create a concrete process that we can use to learn parameters in the network.</p><newline><p>Let's say that at this point we have sent a batch of data <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msup><mi mathvariant='bold'>X</mi><mrow><mo stretchy='false'>(</mo><mi>i</mi><mo stretchy='false'>)</mo></mrow></msup></mrow><annotation encoding='application/x-tex'>\mathbf{X}^{(i)}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.888em;'></span><span class='mord'><span class='mord mathbf'>X</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.888em;'><span style='top:-3.063em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mopen mtight'>(</span><span class='mord mathnormal mtight'>i</span><span class='mclose mtight'>)</span></span></span></span></span></span></span></span></span></span></span></span></eq> into the the network with some initial weights and biases. We now have an outputted prediction. This completes the forward pass for a single batch.</p><newline><p>Now, we quantify the loss using a loss function, this is our objective function that will be minimized using our optimier. For this single batch, we take one step with our optimizer, and we are done with a full forward and backward pass of our neural network.</p><newline><p>This process of forward pass, calculate loss, compute gradients, and update parameters is looped for every batch in our dataset and we take an optimizer step for every batch (every time we go forward). We repeat this process for <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq> number of epochs, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>1</mn></mrow><annotation encoding='application/x-tex'>1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq> epoch is the completion of the forward and backward passes for every batch in the dataset.</p><newline><p>This concludes the discussion of neural network theory. The next section deals with the technicalities that arise when we want to impelement neural networks in program code.</p><newline><h2 id='computational-techniques' tabindex='-1'><a class='header-anchor' href='#computational-techniques'><span>Computational Techniques</span></a></h2><newline><p>Let's take a step away from mathematics and towards engineering. The implementation of neural networks comes with some complexities and issues that need to be attended to in order to attain the most desirable results.</p><newline><h3 id='model-parameters' tabindex='-1'><a class='header-anchor' href='#model-parameters'><span>Model Parameters</span></a></h3><newline><p>Throughout the previous sections, we've talked about weights and biases. However, we only left these as arbitrary variables, because that is fine in mathematics. But, if we want to actually implement neural nets, it's important that we deal with real numbers, not variables.</p><newline><p>When we say model parameters in the context of neural networks, we often mean the weights and biases of each layer. We already know from the previous section that the end values of our weights and biases will be the optimal weights and biases to minimize the loss for the given data. However, when starting out, how do we know what weights and biases to use?</p><newline><p>We are more likely to get stuck in a local minimum if all of the weights are the same. In other words, all of the neurons will learn the same things and the network will be unable to generalize like we want it to.</p><newline><p>In an attempt to optimize the initialization process, parameters are generally initialized using a recent method called kaiming initialization. We sample <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>W</mi><mo>∼</mo><mi mathvariant='script'>N</mi><mo stretchy='false'>(</mo><mn>0</mn><mo separator='true'>,</mo><mo stretchy='false'>(</mo><mfrac><mn>2</mn><msub><mi>n</mi><mi>i</mi></msub></mfrac><msup><mo stretchy='false'>)</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></msup><mo stretchy='false'>)</mo></mrow><annotation encoding='application/x-tex'>W \sim \mathcal{N}(0, (\frac{2}{n_i})^{\frac 1 2})</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord mathnormal' style='margin-right:0.13889em;'>W</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>∼</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.3991em;vertical-align:-0.4451em;'></span><span class='mord mathcal' style='margin-right:0.14736em;'>N</span><span class='mopen'>(</span><span class='mord'>0</span><span class='mpunct'>,</span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mopen'>(</span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8451em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>n</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3281em;'><span style='top:-2.357em;margin-left:0em;margin-right:0.0714em;'><span class='pstrut' style='height:2.5em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.143em;'><span></span></span></span></span></span></span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.4451em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mclose'><span class='mclose'>)</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.954em;'><span style='top:-3.363em;margin-right:0.05em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight'><span class='mopen nulldelimiter sizing reset-size3 size6'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8443em;'><span style='top:-2.656em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'><span class='mord mtight'>2</span></span></span></span><span style='top:-3.2255em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line mtight' style='border-bottom-width:0.049em;'></span></span><span style='top:-3.384em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size3 size1 mtight'><span class='mord mtight'><span class='mord mtight'>1</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.344em;'><span></span></span></span></span></span><span class='mclose nulldelimiter sizing reset-size3 size6'></span></span></span></span></span></span></span></span></span></span><span class='mclose'>)</span></span></span></span></eq>, where <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><msub><mi>n</mi><mi>i</mi></msub></mrow><annotation encoding='application/x-tex'>n_i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.5806em;vertical-align:-0.15em;'></span><span class='mord'><span class='mord mathnormal'>n</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:0em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span></span></span></span></eq> is the number of inputs to layer <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>i</mi></mrow><annotation encoding='application/x-tex'>i</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6595em;'></span><span class='mord mathnormal'>i</span></span></span></span></eq>.</p><newline><h3 id='tensors' tabindex='-1'><a class='header-anchor' href='#tensors'><span>Tensors</span></a></h3><newline><p>Throughout the math for both the forward and backwards pass, we've talked about matrices and vectors. In the context of deep learning, these are simply convenient methods of representing data and computations involving them.</p><newline><p>As you go deeper into your study of neural networks, you may find that we might need more than just a list, or a list of lists to store data. Thus, for mathematical convenience, we use tensors to represent data.</p><newline><p>For context, a rank <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>2</mn></mrow><annotation encoding='application/x-tex'>2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>2</span></span></span></span></eq> tensor can be represented as a matrix, and a rank <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>1</mn></mrow><annotation encoding='application/x-tex'>1</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>1</span></span></span></span></eq> tensor can be represented as a vector. Remember that the mathematical meaning behind these objects is not very useful to us, it's simply a more convenient and computationally efficient way to store information.</p><newline><p>Moving forward in our implementations, we will use tensors to represent our data, weights, and biases.</p><newline><h2 id='from-theory-to-implementation' tabindex='-1'><a class='header-anchor' href='#from-theory-to-implementation'><span>From Theory To Implementation</span></a></h2><newline><p>Okay, so we now know how neural nets work mathematically and in theory. We also have some handy tricks for making neural networks easier to work with computationally. Now, it's time to actually make basic implementations of our theory. In this section, we'll be making a very basic neural network library.</p><newline><p>One interesting exercise might be to follow along without referring to the code in the GitHub page. This will force you to write a large chunk of the automated differentiation API by yourself.</p><newline><p>Note that implementing neural networks from scratch should, in most cases, never be done for practical use. There are existing libraries like <a href='https://pytorch.org'>PyTorch</a> or <a href='https://keras.io'>Keras</a> that allow for the same functionality and more in an efficient and stable manner.</p><newline><h3 id='tensors-1' tabindex='-1'><a class='header-anchor' href='#tensors-1'><span>Tensors</span></a></h3><newline><p>We'll make a very basic tensor class that stores a <a href='https://numpy.org/'>numpy</a> ndarray as its elements. First, let's import numpy.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>import</span> numpy <span class='hljs-keyword'>as</span> np<newline></code></pre><newline><p>Next, we can create our tensor class.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>Tensor</span>: <newline></code></pre><newline><p>The constructor simply stores the elements of the tensor as an <code>ndarray</code> and initializes the gradient objects (for autodiff).</p><newline><p>For autodiff, we need to store a gradient &quot;tape&quot; that keeps track of all operations and also initialize our gradients to <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mn>0</mn></mrow><annotation encoding='application/x-tex'>0</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6444em;'></span><span class='mord'>0</span></span></span></span></eq>.</p><newline><p>Note that we usually work with floating point numbers (<code>float32</code>) in deep learning. We only allow <code>float</code> Tensors for autodifferentiation.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__init__</span>(<span class='hljs-params'>self, els, requires_grad=<span class='hljs-literal'>False</span>, dtype=<span class='hljs-literal'>None</span>, tape=<span class='hljs-literal'>None</span></span>):<newline>    <span class='hljs-comment'># Store the elements of our tensor in a numpy ndarray</span><newline>    self.els = np.array(els, dtype=dtype)<newline>    <span class='hljs-comment'># Decide whether or not we are computing gradients</span><newline>    self.requires_grad = requires_grad<newline>    <span class='hljs-comment'># Initialize an empty gradient tape for autodiff</span><newline>    self.tape = tape <span class='hljs-keyword'>or</span> []<newline>    <span class='hljs-comment'># If the dtype is not &quot;float&quot;, raise an error</span><newline>    <span class='hljs-keyword'>if</span> <span class='hljs-keyword'>not</span> self.els.dtype == <span class='hljs-built_in'>float</span> <span class='hljs-keyword'>and</span> requires_grad:<newline>        <span class='hljs-keyword'>raise</span> TypeError(<span class='hljs-string'>&quot;Autodiff is only allowed for tensors of type \&quot;float\&quot;!&quot;</span>)<newline>    <span class='hljs-comment'># Otherwise, initialize our gradient</span><newline>    <span class='hljs-keyword'>if</span> requires_grad:<newline>        self.zero_grad()<newline>    <span class='hljs-keyword'>else</span>: <newline>      self.grad = <span class='hljs-literal'>None</span><newline></code></pre><newline><p>Note that our <code>zero_grad</code> function is still not defined. The point of this function is exactly what it says---it initializes the gradient to an ndarray with zeros. The reason why we are making this a separate function is because we'll need it later for SGD.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>zero_grad</span>(<span class='hljs-params'>self</span>): <newline>    self.grad = np.zeros_like(self.els)<newline></code></pre><newline><p>We also need a way to make our <code>Tensor</code> subscriptable, meaning that if we try to get the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq>th element of the tensor, we return the <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>n</mi></mrow><annotation encoding='application/x-tex'>n</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>n</span></span></span></span></eq>th item in the <code>ndarray</code>. For convenience, we'll also make sure that we return the <code>els</code> attribute of our <code>Tensor</code> object every time a user tries to print it.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__getitem__</span>(<span class='hljs-params'>self, n</span>):<newline>    <span class='hljs-keyword'>return</span> self.els[n]<newline>    <newline><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__repr__</span>(<span class='hljs-params'>self</span>):<newline>    <span class='hljs-keyword'>return</span> self.els.__str__()<newline></code></pre><newline><p>And we are now done with the base of our Tensor class.</p><newline><h3 id='automated-differentiation' tabindex='-1'><a class='header-anchor' href='#automated-differentiation'><span>Automated Differentiation</span></a></h3><newline><p>Next, let's implement autodiff. We will overload the multiplication, addition, subtraction, and division operations in the <code>Tensor</code> class.</p><newline><p>Before we do that however, it's important to generalize all of our operations. Essentialy, we'll build an API for operations that have derivatives so that we can make our lives easier when actually implementing the operations. Our API takes in the following:</p><newline><ul><newline><li><code>other</code> - The other operand (other than <code>self</code>)</li><newline><li><code>operation</code> - A function that represents the operation that is to be performed</li><newline><li><code>derivative_a</code> - The function for the derivative of the first operand</li><newline><li><code>derivative_b</code> - The function for the derivative of the second operand</li><newline></ul><newline><p>Using this, we can put together a function  definition.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__op</span>(<span class='hljs-params'>self, other, operation, derivative_a, derivative_b=<span class='hljs-literal'>None</span></span>):<newline></code></pre><newline><p>Note that we are not always guaranteed to have another <code>Tensor</code> as the <code>other</code> argument. An easy workaround to this would be to just convert it into one:</p><newline><pre><code class='hljs language-python'><span class='hljs-comment'># Turn the other argument into a tensor if it isn&#x27;t already one</span><newline><span class='hljs-keyword'>if</span> <span class='hljs-keyword'>not</span> <span class='hljs-built_in'>isinstance</span>(other, Tensor):<newline>    other = Tensor([other], dtype=self.els.dtype, requires_grad=<span class='hljs-literal'>False</span>)<newline></code></pre><newline><p>We also need to decide whether or not we want to compute gradients for this new output tensor. Generally, we want to if either one of our operands requires grad.</p><newline><pre><code class='hljs language-python'><span class='hljs-comment'># If either one of our tensors require grad, then the output tensor also requires grad</span><newline>requires_grad = self.requires_grad <span class='hljs-keyword'>or</span> other.requires_grad<newline></code></pre><newline><p>Let's go ahead and compute the output. Note that we need to append the tapes of both this Tensor and the other Tensor to make sure that operations aren't left out when we chain them. If the gradient tape is out of order or has missing operations, our multivariable chain rule will not work.</p><newline><p>Generally, this is taken care of by constructing a directed acyclic graph (DAG) and going backwards in topological order, but that is beyond the scope of our neural network library.</p><newline><pre><code class='hljs language-python'><span class='hljs-comment'># Find the output tensor by executing the given operation</span><newline>out = Tensor(operation(self.els, other.els), requires_grad=requires_grad, tape=(other.tape + self.tape))<newline></code></pre><newline><p>Finally, we add a function that computes the derivatives during the backwards pass. To prevent problems going forward, we'll also make sure to preserve the shapes of the outputs by summing the values on axis <code>0</code></p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>tape_action</span>(): <newline>  <span class='hljs-comment'># Execute the derivative functions for the operation if the gradients exist</span><newline>  <span class='hljs-keyword'>if</span> self.grad <span class='hljs-keyword'>is</span> <span class='hljs-keyword'>not</span> <span class='hljs-literal'>None</span>: <newline>    self.grad = self.grad + derivative_a(self.els, other.els, out.grad)<newline>    <span class='hljs-keyword'>if</span> self.grad.shape != self.els.shape:<newline>      self.grad = np.add.reduce(self.grad)<newline>  <span class='hljs-keyword'>if</span> other.grad <span class='hljs-keyword'>is</span> <span class='hljs-keyword'>not</span> <span class='hljs-literal'>None</span> <span class='hljs-keyword'>and</span> derivative_b <span class='hljs-keyword'>is</span> <span class='hljs-keyword'>not</span> <span class='hljs-literal'>None</span>:<newline>    other.grad = other.grad + derivative_b(self.els, other.els, out.grad)<newline>    <span class='hljs-keyword'>if</span> other.grad.shape != other.els.shape:<newline>      other.grad = np.add.reduce(other.grad)<newline>out.tape.append(tape_action)<newline><span class='hljs-comment'># Return the outputted value</span><newline><span class='hljs-keyword'>return</span> out<newline></code></pre><newline><p>And the &quot;API&quot; is done.</p><newline><p>Moving on to the actual operations, only a few are implemented here. For the full code, head over to the <a href='https://github.com/sripkunda/candl'>GitHub page</a>.</p><newline><p>Remember that our API takes in three functions:</p><newline><ul><newline><li><newline><p><code>operation(a, b)</code> - The operation that is being performed, where <code>a</code> and <code>b</code> are the elements of the operands.</p><newline></li><newline><li><newline><p><code>derivative_a(a, b, dc)</code> - The derivative of <code>a</code> that is added to <code>a.grad</code> as per the chain rule. <code>a</code> and <code>b</code> are the elements of the operands and <code>dc</code> is the gradient of the output.</p><newline></li><newline><li><newline><p><code>derivative_b(a, b, dc)</code> - The derivative of <code>b</code> that is added to <code>b.grad</code> as described above.</p><newline></li><newline></ul><newline><p>Using this, let's override the <code>__add__</code> method of our <code>Tensor</code> object:</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__add__</span>(<span class='hljs-params'>self, other</span>):<newline>    <span class='hljs-keyword'>return</span> self.__op(other, <span class='hljs-keyword'>lambda</span> a, b: a + b, <span class='hljs-keyword'>lambda</span> a, b, dc: dc, <span class='hljs-keyword'>lambda</span> a, b, dc: dc)<newline></code></pre><newline><p>Here, we have an anonymous function <code>lambda a, b: a + b</code> that reads, &quot;the sum of a and b is a + b&quot;.  The other two functions are a bit less obvious. Assuming that <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>z</mi><mo>=</mo><mi>c</mi></mrow><annotation encoding='application/x-tex'>z = c</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal' style='margin-right:0.04398em;'>z</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>c</span></span></span></span></eq>, and <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding='application/x-tex'>c = a + b</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.4306em;'></span><span class='mord mathnormal'>c</span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:0.6667em;vertical-align:-0.0833em;'></span><span class='mord mathnormal'>a</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathnormal'>b</span></span></span></span></eq>, we say that <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>a</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>z</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>c</mi></mrow></mfrac><mfrac><mrow><mi mathvariant='normal'>∂</mi><mi>c</mi></mrow><mrow><mi mathvariant='normal'>∂</mi><mi>a</mi></mrow></mfrac></mrow><annotation encoding='application/x-tex'>\frac{\partial z}{\partial a} = \frac{\partial z}{\partial c}\frac{\partial c}{\partial a}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight'>a</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight' style='margin-right:0.04398em;'>z</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:1.2251em;vertical-align:-0.345em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight'>c</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight' style='margin-right:0.04398em;'>z</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.8801em;'><span style='top:-2.655em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight'>a</span></span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.394em;'><span class='pstrut' style='height:3em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mtight' style='margin-right:0.05556em;'>∂</span><span class='mord mathnormal mtight'>c</span></span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.345em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span></span></span></span></eq>, as per the chain rule. So we say that we add <code>dc</code> to the gradient of <code>a</code> for every addition operation.</p><newline><p>The concepts are the same for subtraction, multiplication, etc.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__sub__</span>(<span class='hljs-params'>self, other</span>):<newline>    <span class='hljs-keyword'>return</span> self.__op(other, <span class='hljs-keyword'>lambda</span> a, b: a - b, <span class='hljs-keyword'>lambda</span> a, b, dc: dc, <span class='hljs-keyword'>lambda</span> a, b, dc: -dc)<newline><newline><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__mul__</span>(<span class='hljs-params'>self, other</span>):<newline>    <span class='hljs-keyword'>return</span> self.__op(other, <span class='hljs-keyword'>lambda</span> a, b: a * b, <span class='hljs-keyword'>lambda</span> a, b, dc: b * dc, <span class='hljs-keyword'>lambda</span> a, b, dc: a * dc)<newline>    <newline><span class='hljs-comment'># ... See the github page.</span><newline></code></pre><newline><p>If you are interested in implementing autodiff by themselves, the list of operations that need to be supported are included below.</p><newline><ul><newline><li>Addition</li><newline><li>Subtraction</li><newline><li>Multiplication</li><newline><li>Division</li><newline><li>Exponents</li><newline><li>Summations (<code>np.sum()</code>)</li><newline><li>Negation</li><newline><li>ReLU</li><newline><li>Sigmoid</li><newline><li>Tanh</li><newline><li>Matrix Multiplication</li><newline></ul><newline><p>Remember that the reverse operation functions, <code>__rsub__</code>, etc. must also be implemented.</p><newline><h3 id='loss-functions' tabindex='-1'><a class='header-anchor' href='#loss-functions'><span>Loss Functions</span></a></h3><newline><p>We now have completed most of what it takes to build neural networks. Implementing MSE is relatively straightforward. Recall that MSE is:</p><newline><section><eqn><span class='katex-display'><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML' display='block'><semantics><mrow><mtext>MSE</mtext><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy='false'>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent='true'><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy='false'>)</mo><mn>2</mn></msup></mrow><annotation encoding='application/x-tex'>\text{MSE} = \frac{1}{n}\sum_{i = 1}^n(y_i-\hat{y}_i)^2</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.6833em;'></span><span class='mord text'><span class='mord'>MSE</span></span><span class='mspace' style='margin-right:0.2778em;'></span><span class='mrel'>=</span><span class='mspace' style='margin-right:0.2778em;'></span></span><span class='base'><span class='strut' style='height:2.9291em;vertical-align:-1.2777em;'></span><span class='mord'><span class='mopen nulldelimiter'></span><span class='mfrac'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.3214em;'><span style='top:-2.314em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord mathnormal'>n</span></span></span><span style='top:-3.23em;'><span class='pstrut' style='height:3em;'></span><span class='frac-line' style='border-bottom-width:0.04em;'></span></span><span style='top:-3.677em;'><span class='pstrut' style='height:3em;'></span><span class='mord'><span class='mord'>1</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.686em;'><span></span></span></span></span></span><span class='mclose nulldelimiter'></span></span><span class='mspace' style='margin-right:0.1667em;'></span><span class='mop op-limits'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:1.6514em;'><span style='top:-1.8723em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'><span class='mord mathnormal mtight'>i</span><span class='mrel mtight'>=</span><span class='mord mtight'>1</span></span></span></span><span style='top:-3.05em;'><span class='pstrut' style='height:3.05em;'></span><span><span class='mop op-symbol large-op'>∑</span></span></span><span style='top:-4.3em;margin-left:0em;'><span class='pstrut' style='height:3.05em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>n</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:1.2777em;'><span></span></span></span></span></span><span class='mopen'>(</span><span class='mord'><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>−</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:1.1141em;vertical-align:-0.25em;'></span><span class='mord'><span class='mord accent'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.6944em;'><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='mord mathnormal' style='margin-right:0.03588em;'>y</span></span><span style='top:-3em;'><span class='pstrut' style='height:3em;'></span><span class='accent-body' style='left:-0.1944em;'><span class='mord'>^</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.1944em;'><span></span></span></span></span></span><span class='msupsub'><span class='vlist-t vlist-t2'><span class='vlist-r'><span class='vlist' style='height:0.3117em;'><span style='top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mathnormal mtight'>i</span></span></span></span><span class='vlist-s'>​</span></span><span class='vlist-r'><span class='vlist' style='height:0.15em;'><span></span></span></span></span></span></span><span class='mclose'><span class='mclose'>)</span><span class='msupsub'><span class='vlist-t'><span class='vlist-r'><span class='vlist' style='height:0.8641em;'><span style='top:-3.113em;margin-right:0.05em;'><span class='pstrut' style='height:2.7em;'></span><span class='sizing reset-size6 size3 mtight'><span class='mord mtight'>2</span></span></span></span></span></span></span></span></span></span></span></span></eqn></section><p>In our library, we will return a function that can be called to compute the loss, so that we can add additional options to the function (such as <code>reduction</code>, specifiying if we want to take the average or only the sum)</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>MSE</span>(): <newline>  <span class='hljs-comment'># Compute the mean squared error loss given a prediction (yhat) and a target (y)</span><newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>compute_loss</span>(<span class='hljs-params'>yhat, y</span>):    <newline>    N = np.prod(y.els.shape, dtype=<span class='hljs-built_in'>float</span>)<newline>    <span class='hljs-keyword'>return</span> ((y - yhat) ** <span class='hljs-number'>2</span>).<span class='hljs-built_in'>sum</span>() / N<newline>  <span class='hljs-keyword'>return</span> compute_loss<newline></code></pre><newline><p>That's it for loss functions!</p><newline><h3 id='blocks-(modules)' tabindex='-1'><a class='header-anchor' href='#blocks-(modules)'><span>Blocks (Modules)</span></a></h3><newline><p>Let's talk about how neural networks are structured. Anything that we can create should preferably be multipurposed for use for many different things.</p><newline><p>In deep learning, we want to generalize the concept of a neural network to each of its components, such as activation functions, or layers. The easiest way to do this is to extract what all of these have in common: some inputs and some outputs. Even a single layer in a neural network is just an input-output gate. In fact, our entire neural network is an input-output gate.</p><newline><p>To make use of this notion, we introduce the concept of blocks, or modules. A module is simply an object that holds some parameters, takes in an input, and transforms it to create an output. Modules can be put together to form layers, groups of layers, or neural networks.</p><newline><p>Let's implement this, starting off with a base class.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>Module</span>: <newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__init__</span>(<span class='hljs-params'>self, *args</span>): <newline>    <span class='hljs-comment'># Initialize module with given arguments as children</span><newline>    self.__children = args <span class='hljs-keyword'>or</span> [] <newline>        <newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>forward</span>(<span class='hljs-params'>self, x</span>):<newline>    <span class='hljs-comment'># Call .forward() on all of the children</span><newline>    <span class='hljs-keyword'>for</span> child <span class='hljs-keyword'>in</span> self.__children:<newline>      x = child.forward(x)<newline>    <span class='hljs-keyword'>return</span> x<newline></code></pre><newline><p>We also need a way to keep track of block parameters. To identify parameters, we can create a very basic class:</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>Parameter</span>: <newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__init__</span>(<span class='hljs-params'>self, data, requires_grad=<span class='hljs-literal'>True</span></span>):<newline>    <span class='hljs-comment'># Set data of parameter</span><newline>    self.data = Tensor(data, requires_grad, <span class='hljs-built_in'>float</span>) <newline></code></pre><newline><p>This will just be a convenient way to keep track of module parameters. It also helps to have a convenient way to get all of the parameters in a module:</p><newline><pre><code class='hljs language-python'><span class='hljs-comment'># Note: This is a method in the module class</span><newline><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>parameters</span>(<span class='hljs-params'>self</span>):<newline>    <span class='hljs-comment'># Fetch all of the parameters by going through each child</span><newline>    parameters = []<newline>    <span class='hljs-keyword'>for</span> child <span class='hljs-keyword'>in</span> self.__children:<newline>      <span class='hljs-keyword'>for</span> (key, value) <span class='hljs-keyword'>in</span> child.__dict__.items():<newline>        <span class='hljs-keyword'>if</span> <span class='hljs-built_in'>isinstance</span>(value, Parameter):<newline>          parameters.append(value)<newline>    <span class='hljs-keyword'>return</span> parameters<newline></code></pre><newline><p>And that's it, we've successfully implemented modules.</p><newline><h3 id='layers' tabindex='-1'><a class='header-anchor' href='#layers'><span>Layers</span></a></h3><newline><p>Using our modules, it helps to give users some starter layers so that they can build their own neural networks.</p><newline><p>Starting off with the linear module, we initialize the weights and biases with kaiming initialization. We then override the forward function with the output computation of a linear layer, <eq><span class='katex'><span class='katex-mathml'><math xmlns='http://www.w3.org/1998/Math/MathML'><semantics><mrow><mi mathvariant='bold'>X</mi><mi mathvariant='bold'>W</mi><mo>+</mo><mi mathvariant='bold'>b</mi></mrow><annotation encoding='application/x-tex'>\mathbf{X}\mathbf{W} + \mathbf{b}</annotation></semantics></math></span><span class='katex-html' aria-hidden='true'><span class='base'><span class='strut' style='height:0.7694em;vertical-align:-0.0833em;'></span><span class='mord mathbf' style='margin-right:0.01597em;'>XW</span><span class='mspace' style='margin-right:0.2222em;'></span><span class='mbin'>+</span><span class='mspace' style='margin-right:0.2222em;'></span></span><span class='base'><span class='strut' style='height:0.6944em;'></span><span class='mord mathbf'>b</span></span></span></span></eq>.</p><newline><pre><code class='hljs language-python'><span class='hljs-comment'># Just a basic linear layer with an optional bias node</span><newline><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>Linear</span>(<span class='hljs-title class_ inherited__'>Module</span>):<newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__init__</span>(<span class='hljs-params'>self, input_neurons, output_neurons, bias=<span class='hljs-literal'>True</span></span>):<newline>    self.weights = Parameter(np.random.normal(<span class='hljs-number'>0</span>, <newline>                                             (<span class='hljs-number'>2</span> / input_neurons)**<span class='hljs-number'>1</span>/<span class='hljs-number'>2</span>, <newline>                                             (input_neurons, output_neurons)))<newline>    self.bias = bias<newline>    <span class='hljs-keyword'>if</span> bias:<newline>      self.biases = Parameter(np.random.randn(output_neurons))<newline><newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>forward</span>(<span class='hljs-params'>self, x</span>):<newline>    out = x.matmul(self.weights.data)<newline>    <span class='hljs-keyword'>if</span> self.bias: <newline>      <span class='hljs-keyword'>return</span> out + self.biases.data<newline>    <span class='hljs-keyword'>return</span> out<newline></code></pre><newline><p>We can add activation functions using the same concept:</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>ReLU</span>(<span class='hljs-title class_ inherited__'>Module</span>):<newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>forward</span>(<span class='hljs-params'>self, x</span>):<newline>    <span class='hljs-keyword'>return</span> x.relu()<newline><newline><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>Sigmoid</span>(<span class='hljs-title class_ inherited__'>Module</span>):<newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>forward</span>(<span class='hljs-params'>self, x</span>):<newline>    <span class='hljs-keyword'>return</span> x.sigmoid()<newline><newline><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>Tanh</span>(<span class='hljs-title class_ inherited__'>Module</span>):<newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>forward</span>(<span class='hljs-params'>self, x</span>):<newline>    <span class='hljs-keyword'>return</span> x.tanh()<newline></code></pre><newline><h3 id='stochastic-gradient-descent' tabindex='-1'><a class='header-anchor' href='#stochastic-gradient-descent'><span>Stochastic Gradient Descent</span></a></h3><newline><p>We've reached the final part of our library: optimization.</p><newline><p>Our optimizer will be a class, one with a function called <code>step()</code>. The purpose of this function is to to take a single gradient step for every parameter in the network. This is usually called for every time we go forward with a batch of data. Every class instance will store the parameters that we are trying to optimize.</p><newline><p>First we can set up a base class, taking in the parameters we want to optimize and the learning rate of the algorithm:</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>class</span> <span class='hljs-title class_'>SGD</span>: <newline>  <span class='hljs-keyword'>def</span> <span class='hljs-title function_'>__init__</span>(<span class='hljs-params'>self, parameters, learning_rate</span>):<newline>    self.parameters = parameters<newline>    self.learning_rate = learning_rate<newline></code></pre><newline><p>Next, we implement SGD as shown <a href='#Gradient-Descent-GD'>here</a>. We also can pass an argument that resets the gradients so that we have an accurate computation for the next forward pass.</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>step</span>(<span class='hljs-params'>self, zero_grad=<span class='hljs-literal'>False</span></span>):<newline>    <span class='hljs-keyword'>for</span> param <span class='hljs-keyword'>in</span> self.parameters: <newline>      param = param.data <span class='hljs-comment'># Get the data inside the parameter</span><newline>      <span class='hljs-comment'># w_i+1 &lt;- w_i - lr * (dL/dw_i)</span><newline>      param.els = param.els - self.learning_rate * param.grad<newline>      <span class='hljs-comment'># Reset the gradient if specified</span><newline>      <span class='hljs-keyword'>if</span> zero_grad:<newline>        param.zero_grad()<newline></code></pre><newline><p>To end it off, we can add another <code>zero_grad</code> method for convenience and flexibility:</p><newline><pre><code class='hljs language-python'><span class='hljs-keyword'>def</span> <span class='hljs-title function_'>zero_grad</span>(<span class='hljs-params'>self</span>): <newline>    <span class='hljs-keyword'>for</span> param <span class='hljs-keyword'>in</span> self.parameters: <newline>      param.zero_grad()<newline></code></pre><newline><p>We've now built a basic neural network library! To see the code in more detail, see the <a href='https://github.com/sripkunda/candl'>github page</a>. If you've made it this far, thanks for reading. I hope you've learned something out of this. For a more in-depth and complete resource for implementing and understanding neural networks, try the free ebook <a href='https://d2l.ai'>Dive into Deep Learning<newline></a></p><newline><p>Last Updated: December 2021</p><newline>
    </div>
</body>
</html>
